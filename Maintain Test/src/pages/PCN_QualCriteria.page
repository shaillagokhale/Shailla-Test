<apex:page id="pg" sidebar="false"  standardController="Concept_Note__c" extensions="ctrlPCNQualCriteria" tabstyle="Qualitative_Factors__tab">
    
 <apex:stylesheet value="{!URLFOR($Resource.GoalsJs, 'assets/css/bootstrap.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.GoalsJs, 'assets/css/bootstrap-responsive.css')}"/>
    <style>
        .headerRowUpper{
            border:1px solid #E0E3E5 !important;
            font-weight:bold !important;         
        }
        .badge{
            margin-right:4px;
        }
        .headerRowLower{
            border:1px solid #E0E3E5 !important;
            font-weight:bold !important;
            background-color:#0066BB !important;
            color:white !important;
            white-space: normal !important;
        }
        .totalRow{
            border-top:1px;
            font-weight:bold !important;
        }
        textarea {
            resize: none;
        }
        .TDstyle{
            /*border-top:1px solid #E0E3E5 !important;
            border-left:1px solid #E0E3E5 !important;
            border-bottom:1px solid #E0E3E5 !important;*/
            border:1px solid #E0E3E5 !important;
            vertical-align: top;
        }
        input{
            width: 50px;            
        }
        label {
            font-weight: bold;
            display: inherit;
        }
        .pageContent {
            color: #4A4A56; 
            font-size: 0.9em; 
            font-weight: bold; 
            padding-left: 1px;
        }
        .pageTitleIcon {
            margin-top: 5px;
            background-image: url("/img/sprites/master.png");
            background-position: 0 -1058px;
            height: 32px;
            width: 32px;
            display: inline;
            float: left;
            margin-right: 5px;
            margin-left: 10px;
        }
        .pageDescription{
            font-size: 1.8em; 
            font-weight: normal;
            line-height: 1.1em;
        }
        .sidebarMenu{
            width : 270px;
        }
        .custPopup{
            background-color: #ffffff;
            border-width: 0px;
            border-radius:10px;
            border-style: solid;
            z-index: 9999;
            left: 34%;
            top:35%;           
            padding:10px;
            position: fixed;
            width:300px;
            height:130px;
        }
        .custPopupOther{
            background-color: #ffffff;
            border-width: 0px;
            border-radius:10px;
            border-style: solid;
            z-index: 9999;
            left: 34%;
            top:35%;           
            padding:10px;
            position: fixed;
            width:300px;
            height:130px;
        }
        .custPopupRating{
            background-color: #ededed;
            border-width: 0px;
            border-radius:10px;
            border-style: solid;
            z-index: 9999;
            left: 34%;
            top:35%;           
            padding:10px;
            position: fixed;
            width:350px;
            height:130px;
        }
        .RequestUpdatedOutputpanel{
            overflow-y:scroll;
            height:auto;
            max-height:285px;            
            width:520px;            
        }
        .custPopupToRequestUpdated{
            background-color: #ffffff;
            border-width: 0px;
            border-radius:10px;
            border-style: solid;
            z-index: 9999;
            left: 34%;
            top:35%;           
            padding:10px;
            position: fixed;
            width:520px;
            height:350px;
        }
        .Outputpanelmain{
            overflow-y:scroll;
            height:auto;
            max-height:200px;            
            width:350px;            
        }
         .custPopupToFunctionalTeam{
            background-color: #ffffff;
            border-width: 0px;
            border-radius:10px;
            border-style: solid;
            z-index: 9999;
            left: 34%;
            top:35%;           
            padding:10px;
            position: fixed;
            width:350px;
            height:280px;
        }
        .popupBackground{
            background-color:black;
            opacity: 0.50;
            filter: alpha(opacity = 20);
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: 9998;
            top: 0;
            left: 0;
        }       
        .TGFbtn-mini{
            margin-top:6px;
            margin-right:12px;
        }
        h3{
            font-size:24px;
        }
        .span2{
            width:9%;
        }
        .tdBorderStyle{
           border-right: 1px solid #DDDDDD !important;           
        }
      
        .helpTextPopup{ 
            padding:10px;
            background: #FFF4DB; 
            border: 4px solid #c2e1f5; 
            z-index: 97;   
            position: absolute; 
            left:10%;
            margin-left: 108px;
            margin-top: -66px;
            width:400px;
        }     
        
          .helpTextAdjustment{ 
            padding:10px;
            background: #FFF4DB; 
            border: 4px solid #c2e1f5; 
            z-index: 97;   
            position: absolute; 
            left:30%;
            margin-left: 108px;
            margin-top: -66px;
            width:400px;
        }         
        .header {
        background-color:#2492B9;
        color:#ffffff;
        font-weight:bold;
        font-size:14px; !important;
        border-right: 1px solid #DDDDDD;
        }
    </style>
 <script>    
    
    var strRecordTypeName;
    //added by 
    var strButtonClicked;
  
    //end added by 
    function OnclickPCNStatusToAccepted(){      
       document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;        
       afChangePCNStatusToAccepted();  
       strRecordTypeName = '';        
       document.getElementById('pg:frm:tstpopup').style.display = 'none';       
       return false;
    }
    function OnclickPCNStatusToRequestUpdated(){             
       afchangePCNStatusToRequestUpdated();              
    } 
    function OnclickSavePCNRequestUpdated(){                         
       afsavePCNRequestUpdated();        
    }
    function cannotsubmitall(){
        alert('Please either accept or request a revision for all Qualitative Factors before final submission.')
    }
    function cannotsubmitAbsorptiveCapacity(){
        alert('Please accept or request a revision to the EFR data for absorptive capacity.')
    }
    function OnclickPCNStatusToAcceptedIRI(){      
       document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;   
       afChangePCNStatusToAccepted();  
       strRecordTypeName = '';        
       document.getElementById('pg:frm:tstpopupCNE').style.display = 'none';       
       return false;
    }      
    function OpenPopup(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;        
        if(strRecordTypeName  == 'Performance' && PopupPanelId == 'pg:frm:tstpopup'){
            document.getElementById('pg:frm:optAcceptText').innerHTML = 'Are you sure you want to accept the presented performance rating?';
        }
        else if(strRecordTypeName == 'Impact' && PopupPanelId == 'pg:frm:tstpopup'){
            document.getElementById('pg:frm:optAcceptText').innerHTML = 'Are you sure you want to accept the presented impact rating?';
        }
        else if(PopupPanelId == 'pg:frm:tstpopup'){
            document.getElementById('pg:frm:optAcceptText').innerHTML = 'Are you sure you want to accept this qualitative factor rating?';
        }
        document.getElementById(PopupPanelId).style.display = '';
        return false;
    }
    function ClosePopup(PopupPanelId){
        if(document.getElementById(PopupPanelId) != null) {
            document.getElementById(PopupPanelId).style.display = 'none';
            document.getElementById('pg:frm:hdnRequestUpdateshowpanel').value = 'No'; 
            document.getElementById('pg:frm:hdnRequestUpdateshowpanelOther').value = 'No'; 
            document.getElementById('pg:frm:hdnFunctionalTeampanel').value = 'No';
        
        }
        return false;
    }
    
    function OpenPopupRequestUpdated(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;             
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
        document.getElementById('pg:frm:hdnRequestUpdateshowpanel').value = 'Yes';  
        if(PopupPanelId == 'AC Set Cap Amount'){
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'ACYes';  
        }
        else if(PopupPanelId == 'FAC Set Cap Amount'){
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'FACYes'; 
        }
        else{
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'ACNo';
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'FACNo';
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'ACNo';
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'FACNo';
            
        }
        afretrievePCNRequestUpdateInformation();        
        return false;
    }
     //added by 
    function SetNoOtherConsideration(RecodTypeName,PopupPanelId){
      
        strRecordTypeName = RecodTypeName;             
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
        var panelDisp = document.getElementById(PopupPanelId);
        if(panelDisp != null) {
            panelDisp.style.display = ''; 
        }
        return false;
    }
     //added by 
    function SetSubmittedRecordType(RecodTypeName,PopupPanelId){
        var panelDisp = document.getElementById(PopupPanelId);
        /*if(RecodTypeName == 'Absorptive_Capacity') {
            strRecordTypeName = RecodTypeName;             
            document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
           
            if(panelDisp != null) {
                panelDisp.style.display = ''; 
            } else {
                afSubmitReview();  
            }
        } else {*/
            if(panelDisp != null) {
                panelDisp.style.display = ''; 
            } 
        //}        
        return false;
    }
    //added by 
    function OpenPopupRequestUpdatedNew(PopupPanelId,RecodTypeName,Type){
        strRecordTypeName = RecodTypeName;             
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
        document.getElementById('pg:frm:hdnRequestUpdateshowpanel').value = 'Yes';  
        if(Type == 'Set Cap Amount'){
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'Set Cap Amount';
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'ACYes';    
        }
        else if(Type == 'Justified Allocation'){
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'Justified Allocation'; 
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'ACNo';
        }
        else{
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'ACNo';
            document.getElementById('pg:frm:hdnshowsetCapAmount').value = 'FACNo';
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'ACNo';
            document.getElementById('pg:frm:hdnshowJustifiedAllocation').value = 'FACNo';
           
        }
       
        afretrievePCNRequestUpdateInformation();        
        return false;
    }
    //end added by
    //added by
    function OpenPopupRequestUpdatedOther(PopupPanelId,RecodTypeName,Type){
        strRecordTypeName = RecodTypeName; 
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;   
                      
        document.getElementById('pg:frm:hdnRequestUpdateshowpanelOther').value = 'Yes'; 
        afretrievePCNRequestUpdateInformation();      
        return false;
    }
    //end added by 
    function OpenPopupFunctionalTeam(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;        
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
        document.getElementById('pg:frm:hdnFunctionalTeampanel').value = 'Yes';        
        afretrieveFunctionalTeamFiles();
        return false;
    }    
    
    /*function OpenPopupRating(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;          
        document.getElementById(PopupPanelId).style.display = '';
        if(document.getElementById('pg:frm:optRating') != null){      
            document.getElementById('pg:frm:optRating').innerHTML = 'General information about the factor and its calculation and a link to download the excel file of source data.';
        }
        return false;
    }*/   
    
    function OnclickSetCapAmountPopUp(){
       document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;        
       afSetCapAmountPopUp(); 
       strRecordTypeName = '';            
       return false;
    }
    //Added start
    function OnclickSaveOtherConsideration(RecodTypeName,Type){
        strRecordTypeName = RecodTypeName;        
        document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;
        document.getElementById('pg:frm:hdnRequestUpdateshowpanelOther').value = 'Yes';
        if(Type == 'Save'){ 
            document.getElementById('pg:frm:hdnUpdateOtherConsideration').value = 'SaveOther'; 
        }
        if(Type == 'NoOther'){
            document.getElementById('pg:frm:hdnUpdateOtherConsideration').value = 'NoOther'; 
        }
       
                                  
        afAddConsiderations(); 
        strRecordTypeName = '';            
        return false;
    }
    function OnclickSubmitOtherConsideration(RecodTypeName,PopupPanelId){
       strRecordTypeName = RecodTypeName;        
       document.getElementById('pg:frm:hdnRecordTypeName').value = strRecordTypeName;  
       
       var panelDisp = document.getElementById(PopupPanelId);
       afSubmitOtherConsiderations(); 
       if(panelDisp != null) {
            panelDisp.style.display = none; 
       }
       strRecordTypeName = '';            
       //return false;
    }
    //end update
     function OpenPopupforRiskMitigation(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;           
        var QualifiesRisk = '{!if(lstRisk.size>0,lstRisk[0].Qualifies_for_Risk_Mitigation__c,'')}';          
        if(QualifiesRisk == 'Yes'){
            document.getElementById('RiskMitigation').style.display = '';
        }       
        document.getElementById(PopupPanelId).style.display = '';
        return false;
    }
    function OpenPopupRequestUpdatedRiskMiti(PopupPanelId,RecodTypeName){
        strRecordTypeName = RecodTypeName;        
        var QualifiesRisk = '{!if(lstRisk.size>0,lstRisk[0].Qualifies_for_Risk_Mitigation__c,'')}';            
        if(QualifiesRisk == 'Yes'){
            document.getElementById('RiskMitigation').style.display = '';
        }       
        document.getElementById(PopupPanelId).style.display = '';
        return false;
    }
    function onMouseOverHelpTextShow(PopupPanelId,HelpTextValue){
        if(HelpTextValue.innerHTML != ''){
            document.getElementById(PopupPanelId).style.display = ''; 
        }
    }
    function onMouseOutHelpTextHide(PopupPanelId){        
      document.getElementById(PopupPanelId).style.display = 'none';        
    }    
    function onClickSubmitAll(){                  
      afSubmitAll();
      return false;           
    }
     function onClickSubmit(){                  
      afSubmit();
      return false;           
    }
    function onclickACSubmit(){
        afSubmitReview();
        return false;
    }
    function onClickSharingButton(){
        window.open('/p/share/AccSharingDetail?parentId={!Concept_Note__c.CCM_New__c}');
    }
    function showProcessing(){
        document.getElementById('divProcessing').style.display = '';
        document.getElementById('pg:frm:hdnRequestUpdateshowpanel').value = 'Yes';
        
    }
    function showProcessingOther(){
        document.getElementById('divProcessing').style.display = '';
        document.getElementById('pg:frm:hdnRequestUpdateshowpanelOther').value = 'Yes';
        
    }
    
    function ChangeOCProposedAmount(FAmount,OCProposedAmount,Maximum,Minimum){
       
        var OCProposedAmt = document.getElementById(OCProposedAmount);  
        if(OCProposedAmt.value != '' && FAmount != '' && !isNaN(OCProposedAmt.value) 
            && Maximum != '' && (Number(OCProposedAmt.value) + Number(FAmount) ) > Number(Maximum)){                          
            document.getElementById('OpProAmountMax').style.display = '';             
        }
        else{
           document.getElementById('OpProAmountMax').style.display = 'none';            
        }
       
        if(OCProposedAmt.value != '' && FAmount != '' && !isNaN(OCProposedAmt.value) 
            && Minimum != '' && (Number(OCProposedAmt.value)+ Number(FAmount)) < Number(Minimum)){  
            document.getElementById('OpProAmountMin').style.display = '';             
        }
        else{
            document.getElementById('OpProAmountMin').style.display = 'none';
        }
    }
    function ChangeACProposedAmount(ACProposedAmount,Maximum,Minimum){
          
        var ACProposedAmt = document.getElementById(ACProposedAmount);   
        if(ACProposedAmt.value != '' && !isNaN(ACProposedAmt.value) 
            && Maximum != '' && Number(ACProposedAmt.value) > Number(Maximum)){                    
            document.getElementById('opSetCapAmtMax').style.display = '';             
        }
        else{
            document.getElementById('opSetCapAmtMax').style.display = 'none';
        }
        if(ACProposedAmt.value != '' && !isNaN(ACProposedAmt.value) 
            && Minimum != '' &&  Number(ACProposedAmt.value) < Number(Minimum)){                            
            document.getElementById('opSetCapAmtMin').style.display = '';             
        }
        else{
           document.getElementById('opSetCapAmtMin').style.display = 'none';  
        }        
    }
  
</script>
<body>
<apex:form id="frm">
    <apex:pagemessages ></apex:pagemessages>
    <apex:inputHidden id="hdnRecordTypeName" value="{!strRecordTypeName}"/>
    <apex:inputHidden id="hdnRequestUpdateshowpanel" value="{!ShowRequestUpdatePanel}"/>
    <apex:inputHidden id="hdnRequestUpdateshowpanelOther" value="{!ShowRequestUpdatePanelOther}"/>
    <apex:inputHidden id="hdnFunctionalTeampanel" value="{!ShowFunctionalTeamPanel}"/>  
    <apex:inputHidden id="hdnshowsetCapAmount" value="{!showsetCapAmount}"/>  
    <!--ADDED START-->
    <apex:inputHidden id="hdnshowJustifiedAllocation" value="{!strShowJustifiedAllocation}"/>
    <apex:inputHidden id="hdnUpdateOtherConsideration" value="{!strUpdateOtherConsideration}"/>    
    <!--ADDDED END-->  
    <apex:actionFunction name="afChangePCNStatusToAccepted" action="{!changePCNStatusToAccepted}"/>             
    <apex:actionFunction name="afSetCapAmountPopUp" action="{!SetCapAmountPopUp}"/>
    <apex:actionFunction name="afAddConsiderations" action="{!SaveOtherConsiderations}"/>      
    <apex:actionFunction name="afSubmitOtherConsiderations" action="{!SubmitOtherConsiderations}"/>
    <apex:actionFunction name="afSubmitAll" action="{!SubmitAll}"/> 
    <apex:actionFunction name="afSubmit" action="{!Submit}"/>   
    <apex:actionFunction name="afSubmitReview" action="{!changePCNStatusToRequestUpdatedSubmitted}"/>   
    <apex:actionFunction name="afretrievePCNRequestUpdateInformation" action="{!retrievePCNRequestUpdateInformation}"/> 
    
    <apex:actionFunction name="afchangePCNStatusToRequestUpdated" action="{!changePCNStatusToRequestUpdated}"/> 
    <apex:actionFunction name="afsavePCNRequestUpdated" action="{!savePCNRequestUpdated}"/>
    <apex:actionFunction name="afretrieveFunctionalTeamFiles" action="{!retrieveFunctionalTeamFiles}"/> 
  <div class="container">
    <!-- Content -->
    <div class="row" style="margin-left:-22px !important;">
      <div class="span12">
        <h3><p>{!Concept_Note__c.Name}</p>
        <p>{!Concept_Note__c.CCM_new__r.Country__r.Name} {!Concept_Note__c.Component__c} Qualitative Factors Adjustment</p></h3>
        <br/>
        
        <apex:outputPanel rendered="{!if(Concept_Note__c.Display_PCN_Eligibility_Message__c = TRUE,true,false)}"> 
        
        <div id="Infopanel" class="alert alert-info">
                        <button type="button" class="close" data-dismiss="alert" onclick="closePanel();">
                         
                        </button>
                        <b>
                        <p>
                        This eligibility list has been prepared solely for the purpose of data verification for qualitative factors input. It is confidential and should not be shared with countries. The Global Fund’s Eligibility List for 2014 will be published in January 2014 when updated disease burden information has been received. 
                        </p>
                        <p>
                        This list provides you with the likely eligibility of countries/economies for 2014, based on:
                        </p>
                        <p>
                        ·         The World Bank income classifications published in 2013 (which will be used in the 2014 eligibility list); and
                        </p>
                        <p>
                        ·         Disease burden estimates received from WHO and UNAIDS in January 2013 (updated estimates will be received in December 2013 and used in the final 2014 eligibility list).
</p>
<p>
Global Fund eligibility of ‘low income’ and ‘lower-middle income’ countries is determined by income level alone and will not change. Since the eligibility of ‘upper-middle income’ (UMI) countries is determined by income level and disease burden data, updated estimates from technical partners may result in a change in eligibility for UMIs for 2014.
</p>
                    </b>
                    </div>

 </apex:outputPanel>                    
                    
        <p>
          This portal is for reviewing qualitative factor inputs that feed into eligible countries’ allocations. 
        </p>  
         <p> 
          As stipulated by the Decision Point GF/B28/DP4, "qualitative factors will adjust the initial figures derived from the 
          <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextFormula}','{!$Component.txthelpTextformula}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextFormula}');">                      
                <u>allocation formula</u>
          </apex:outputPanel>
          
         <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextFormula" style="display:none;margin-top: 28px;">
                <apex:outputText id="txthelpTextformula" style="font-weight:normal !important;color:#000000 !important;" >
                    A quantitative calculation of the “fair” share of
                    funding which should be allocated to each disease component, based on the country's disease burden and ability to pay.
                </apex:outputtext>
         </apex:outputpanel>         
         {disease burden/ability to pay} to account for the specific circumstances in each country the allocation formula might not capture."           
        </p>
        <p>  
          Country teams are asked to review and supplement the information related to qualitative factors for each of their countries / components.  They may also add any other information they believe the Global Fund should take into account to decide the country`s allocation. Feedback from Country teams will be reviewed by various teams teams. A management panel will take the final allocation decisions.
          
        </p>  
         <p>
             <a href="/servlet/servlet.FileDownload?file=015b0000000ZgJq" style="color:#0088CC !important;">See a detailed description of this process.</a>
         </p>     
      </div>  
     
      
      
 <table>
   <!--Panel that shows if the CN is in the PIIRR Review or Submitted stage-->            
     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review'||Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Submitted' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">    
    <tr>
     <td style="vertical-align:top">
      <div class="span2">
       <div class="task_summary border">
         <br/><br/>
         <div class="number">
           <div class="label label-info">  
           <h6>Deadline</h6><br/>
           <apex:outputPanel styleclass="label label-info" style="background:#FA5858 !important;" rendered="{!if(Concept_Note__c.P_I_IR_Review_Deadline__c != null,true,false)}">
               <apex:outputField value="{!Concept_Note__c.P_I_IR_Review_Deadline__c}"/>
           </apex:outputPanel>
           </div>
           <br/><br/>
           <div class="label label-info">
           <h6>Status</h6> <br/>
           <!--<apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized'
                                       && lstImpact.Size > 0 && lstPerformance.Size > 0 && lstIncreasingReatofInfection.Size > 0,true,false)}">
               <span class="label label-info">
                   {!strStatusImpactPerformance }
               </span>
           </apex:outputPanel>-->
           <!--<apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Submitted' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">-->
           <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Pre-Release' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != '',true,false)}">
               <span class="label label-info" style="background:{!if(objConceptNote.P_I_IR_and_Risk_Status__c == 'Data Finalized' || objConceptNote.P_I_IR_and_Risk_Status__c == 'Accepted','#5BB75B',if(objConceptNote.P_I_IR_and_Risk_Status__c == 'Under Review','#2E9AFE',if(objConceptNote.P_I_IR_and_Risk_Status__c == 'Update Requested','#FAA732','')))} !important;">
                   {!objConceptNote.P_I_IR_and_Risk_Status__c}
               </span>
           </apex:outputPanel>
           </div>
          </div>
       </div>
     </div>
     </td>
     <td>
     <div class="span10">
      <div class="task border">
        <div class="task_details ">
          <h3>Performance, Impact, Increasing Rate of Infection, and Risk</h3>
          <div class="">  
              <p>The performance and impact ratings and rate of infection and risk status for this country-component, displayed below, will be used to calculate the country's funding allocation. Please review the data below and either indicate your acceptance or request a revision. If you request a revision, you will be asked to provide a justification.</p>          
          </div>
        </div>        
        <div class="task_workspace">
           <table id="QC_table" cellspacing="0" cellpadding="0" style="border-collapse: separate !important;" class="table table-striped">
             <col width="200px" />
             <col width="250px" />
             <col/>
             <col width="200px"/>
             <col/>
             <col/>
             <thead>
               <tr>
                 <th width="20%" class="header">Factor</th>
                 <th width="20%" class="header">Rating</th>
                 <th width="20%" style="font-weight:normal !important;background:#2492B9;border-right: solid 1px #DDDDDD">
                     <!--<a href="#" style="color:#ffffff !important;"> <u>Theoretical adjustment</u></a>-->
                     <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextAdjustment}','{!$Component.txthelpTextAdjustment}');"  onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextAdjustment}');">                      
                         <h5><u style="color:#ffffff;"><font style="color:#ffffff;font-weight:bold;font-size:14px;">Theoretical adjustment</font></u></h5>
                     </apex:outputPanel>
                     
                     <apex:outputpanel styleClass="helpTextAdjustment" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextAdjustment}','{!$Component.txthelpTextAdjustment}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextAdjustment}');" id="ophelpTextAdjustment" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextAdjustment" style="font-weight:normal !important;color:#000000 !important;" >
                                Adjustments for qualitative factors are first made on a theoretical basis to 
                                <br/>give a percentage of the initial disease component allocations. Following 
                                <br/>these adjustments, all components in a band (the group of countries a  
                                <br/>component falls into based on its disease burden and ability to pay) need  
                                <br/>to be rescaled so that the total allocations to components in a  band 
                                <br/>equals the total amount of funds available in the band. As such, actual 
                                <br/>adjustments will not likely be exactly equal to the theoretical adjustment.<br/>
                                <a href="/servlet/servlet.FileDownload?file=015b0000000ZgJq" style="color:#0088CC !important;"> See detailed description document for more information</a>
                             </apex:outputtext>
                     </apex:outputpanel>
                 </th>
                 <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                     <th width="20%" class="header">Action</th>                 
                     <th width="10%" class="header">Status</th>
                 </apex:outputPanel>
                 <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                     <th  width="10%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Reviewer comments</th>
                 </apex:outputPanel>
               </tr>
             </thead>
               <tbody>
                <tr>
                   <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;">                      
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextBaseLine}','{!$Component.txthelpTextBaseLine}');"
                         onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextBaseLine}');" >
                         <h5><u>Baseline</u></h5>     
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextBaseLine" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextBaseLine"> For qualitative factors, disease component allocations are reduced to 70% of the level indicated by the allocation formula (after external financing and MRL taken into account).Then, starting at 70%, components are allocated adjustments based on Performance, Impact and Increasing Rates of Infection. </apex:outputtext>
                        </apex:outputpanel>
                        <br/>                     
                   </td>
                   <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">                     
                   </td>
                   <td style="vertical-align:middle;" class="tdBorderStyle" width="20%">  
                       70%                                   
                   </td>
                   <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                       <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                       </td>
                       <td width="10%" style="vertical-align:middle;" class="tdBorderStyle">                                          
                       </td>
                   </apex:outputPanel>
                   <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                       <td class="tdBorderStyle" style="vertical-align:middle;" width="10%"></td>
                   </apex:outputPanel>
                 </tr>
     <!--PERFORMANCE BUTTON-->            
                 <tr>
                   <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;border-left: 1px solid #DDDDDD !important;">
                      <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextPerformance}','{!$Component.txthelpTextPerformance}');"
                         onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextPerformance}');" >
                             <h5><u>Performance</u>: Confirm Rating</h5>
                       </apex:outputPanel>
                       <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextPerformance" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextPerformance" value="Performance is the weighted average, indicator-based performance of all past grants over the last 24 months that would apply to a particular disease component."/>
                       </apex:outputpanel>
                       <br/>
                      <apex:commandLink value="See details/guidance" action="/servlet/servlet.FileDownload?file=015b0000000ZgKF" target="_blank" style="color:#0088CC !important;"/> 
                   </td>
                   <td width="20%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">
                      <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                          <b>{!if(lstPerformance.size>0,lstPerformance[0].Initial_Performance_Rating__c,'')}</b>  &nbsp;
                      </apex:outputText>                                          
                    
                      <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                          <b>{!if(lstPerformance.size>0,lstPerformance[0].Performance_Rating__c,'')}</b>
                      </apex:outputText>
                      <br/>
                      <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextPerformance}','{!$Component.txthelpTextPerformance}');"
                         onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextPerformance}');" rendered="{!if(lstPerformance.size>0 && lstPerformance[0].LFA_Verification_Needed__c,true,false)}">
                         LFA verification needed<br/>
                       </apex:outputPanel>                       
                       <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextLfaVarification" style="display:none;margin-top:28px;">
                            <apex:outputText id="txthelpTextLfaVarification" value=": LFA verification has been requested for this data. You will be notified if the performance rating changes after LFA verification."/>
                       </apex:outputpanel>
                       <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                           <apex:commandLink value="Download final data" action="/servlet/servlet.FileDownload?file=015b0000000awd5" target="_blank" style="color:#0088CC !important;"/>   
                       </apex:outputPanel>
                       <apex:outputText >
                        <br>Please save file before opening</br>
                        </apex:outputText>
                   </td>
                   <td style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle" width="20%">  
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review'||Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Submitted',true,false)}">
                           + {!if(lstPerformance.size>0, lstPerformance[0].Initial_Performance_Theoretical_Adjust__c,'')}% (of 25% possible) &nbsp;
                       </apex:outputText>
                      
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                       + {!if(lstPerformance.size>0, lstPerformance[0].Performance_Theoretical_Adjustment__c,'')}% (of 25% possible)
                       </apex:outputText>                             
                   </td>
                   <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                       <td width="20%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">

                                <apex:outputPanel rendered="{!if(lstshare[0].HasEditAccess == true && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;font-weight:bold !important;" onclick="return OpenPopup('{!$Component.tstpopup}','Performance');" value="Accept"></apex:commandLink>
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;font-weight:bold !important;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Performance');" value="Request Revision"/>
                                      <!--<apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                                         <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold !important;" onclick="onClickSharingButton();return false;" value="Share"/>
                                     </apex:outputPanel>-->
                                </apex:outputPanel>   
                                                                      
                        </td>
                        <td width="10%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">                       
                               <span class="label label-success" style="display:{!if(lstPerformance.size>0 && lstPerformance[0].Status__c != '' && lstPerformance[0].Status__c != '','','none')};background:{!if(lstPerformance.size>0 && (lstPerformance[0].Status__c == 'Accepted' || lstPerformance[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstPerformance.size>0 && lstPerformance[0].Status__c == 'Update Requested','#FAA732',if(lstPerformance.size>0 && lstPerformance[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">{!if(lstPerformance.size>0,lstPerformance[0].Status__c,'')}
                               </span> 
                        </td>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                       <td class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;" width="10%">
                           <apex:commandLink style="color:#0088CC !important;" value="View reviewer comments" rendered="{!if(lstPerformance.size>0 && (lstPerformance[0].Functional_Team_Comments__c != null && lstPerformance[0].Functional_Team_Comments__c != ''),true,false)}"  onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Performance');" /><br/>
                           <apex:commandLink value="Note on final performance ratings" action="/servlet/servlet.FileDownload?file=015b0000000awdF" target="_blank" style="color:#0088CC !important;"/>                              
                       </td>
                    </apex:outputPanel>
                 </tr>
    <!--IMPACT ROW-->           
                 <tr style="background-color: #F9F9F9">
                     <td width="20%" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;" class="tdBorderStyle">
                         <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextImapct}','{!$Component.txthelpTextImpact}');"
                             onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextImapct}');" >
                             <h5><u>Impact</u>: Confirm Rating</h5>
                         </apex:outputPanel>
                         <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextImapct" style="display:none;margin-top: 28px;">
                             <apex:outputText id="txthelpTextImpact" value="Impact is defined as progress made by programs in reducing mortality and morbidity of three diseases to meet the 2015 MDGs 6/international targets."/>
                         </apex:outputpanel>
                         <br/>
                         <apex:commandLink value="See details/guidance" action="/servlet/servlet.FileDownload?file=015b0000000ZgLN" target="_blank" style="color:#0088CC !important;"/>
                     </td>
                     <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                         <!--Insert impact rating field -->                         
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                             <b>{!if(lstImpact.size>0,lstImpact[0].Initial_Impact_Rating__c,'')}</b> &nbsp;
                         </apex:outputText>
                        
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                             <b>{!if(lstImpact.size>0,lstImpact[0].Impact_Rating__c,'')}</b>
                         </apex:outputText>                                                  
                         <br/>                          
                         <!--<apex:commandLink style="color:#0088CC !important;" value="See data" action="/servlet/servlet.FileDownload?file=015b0000000b4Ms"/>-->
                         <apex:commandLink style="color:#0088CC !important;" value="Download data" action="/servlet/servlet.FileDownload?file=015b0000000b4Ms" target="_blank"/>
                         <apex:outputText >
                        <br>Please save file before opening</br>
                        </apex:outputText>
                         <!--<a href="#">See details</a>-->
                     </td>
                     <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                        <apex:outputpanel rendered = "{!if(lstPerformance.size>0 && (lstPerformance[0].Initial_Performance_Rating__c == 'C' || lstPerformance[0].Performance_Rating__c == 'C') ,false,true)}">                       
                           <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                               + {!if(lstImpact.size>0, lstImpact[0].Initial_Impact_Theoretical_Adjustment__c,'')}% (of 15% possible) &nbsp;
                           </apex:outputText>
                          
                           <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                               + {!if(lstImpact.size>0, lstImpact[0].Impact_Rating_Theoretical_Adjustment__c,'')}% (of 15% possible)
                           </apex:outputText>
                        </apex:outputpanel>
                        <apex:outputpanel rendered = "{!if(lstPerformance.size>0 && (lstPerformance[0].Initial_Performance_Rating__c == 'C' || lstPerformance[0].Performance_Rating__c == 'C') ,true,false)}">
                          Countries with a performance rating of “C” for a given component are ineligible for an impact adjustment. 
                        </apex:outputpanel>      
                     </td>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                         <td width="20%" class="tdBorderStyle" style="vertical-align:middle;">
                             
                                 <apex:outputPanel rendered="{!if(lstshare[0].HasEditAccess == true && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopup}','Impact');" value="Accept"/>
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Impact');" value="Request Revision"/>
                                     <!--<apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                                         <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold;" onclick="onClickSharingButton();return false;" value="Share"/>
                                     </apex:outputPanel>-->
                                 </apex:outputPanel>
                                                       
                         </td>                     
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">                        
                             <span class="label label-success" style="display:{!if(lstImpact.size>0 && lstImpact[0].Status__c != '' && lstImpact[0].Status__c != '','','none')};background:{!if(lstImpact.size>0 && (lstImpact[0].Status__c == 'Accepted' || lstImpact[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstImpact.size>0 && lstImpact[0].Status__c == 'Update Requested','#FAA732',if(lstImpact.size>0 && lstImpact[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                                 {!if(lstImpact.size>0,lstImpact[0].Status__c,'')}
                             </span>                        
                         </td>
                     </apex:outputPanel>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">
                             <apex:commandLink style="color:#0088CC !important;" rendered="{!if(lstImpact.size>0 && (lstImpact[0].Functional_Team_Comments__c != null && lstImpact[0].Functional_Team_Comments__c != ''),true,false)}"  value="View reviewer comments" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Impact');"/>                           
                         </td>   
                     </apex:outputPanel>        
                 </tr>           
                 <tr>
                   <td width="20%" style="vertical-align:middle;background:#ffffff !important;border-left: 1px solid #DDDDDD !important;" class="tdBorderStyle">
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextIRI}','{!$Component.txthelpTextIRI}');"
                             onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextIRI}');" >
                             <h5><u>Increasing Rate of Infection</u>: Provide Additional Data</h5>
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextIRI" style="display:none;margin-top: 28px;">
                                <apex:outputText id="txthelpTextIRI" value="An Increasing Rate of Infection is defined as an emerging or resurging infection in HIV, TB or malaria due to a funding gap. Due to a lack of partner data, CTs are encouraged to upload any existing data they know about, if necessary, reaching out to CCMs."/>
                        </apex:outputpanel> 
                        <br/>
                        <apex:commandLink value="See details/guidance" action="/servlet/servlet.FileDownload?file=015b0000000ZgL3" target="_blank" style="color:#0088CC !important;"/>
                        <br/> <br/>
                        <apex:outputtext value="See below links for letters to send to CCMs (if desired) and excel template for submitting data:" style="font-size:85%"/><br/>               
                        <a href="/servlet/servlet.FileDownload?file=015b0000000ZgK0" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}" style="color:#0088CC !important;">Letter to CCM (En)</a><br/>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'SPANISH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlX0" style="color:#0088CC !important;" value="Letter to CCM (Es)"/><br/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'FRENCH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlWq" style="color:#0088CC !important;" value="Letter to CCM (Fr)"/><br/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'PORTUGUESE',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlWv" style="color:#0088CC !important;" value="Letter to CCM (Pt)"/><br/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'RUSSIAN',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlXv" style="color:#0088CC !important;" value="Letter to CCM (Rs)"/><br/>
                        </apex:outputpanel>                                                  
                        
                        <a href="/servlet/servlet.FileDownload?file=015b0000000ZgKo" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review'|| Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}" style="color:#0088CC !important;">Excel Template (En)</a><br/>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'SPANISH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYs" style="color:#0088CC !important;" value="Excel Template (Es)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'FRENCH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYh" style="color:#0088CC !important;" value="Excel Template (Fr)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'PORTUGUESE',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYc" style="color:#0088CC !important;" value="Excel Template (Pt)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'RUSSIAN',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYx" style="color:#0088CC !important;" value="Excel Template (Rs)"/>
                        </apex:outputpanel>
                   </td>
                   <td width="20%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">
                       <apex:inputHidden value="{!Concept_Note__c.Language__c}"/>
                        <!--Insert increasing rate of infection field -->
                        
      <!--INCREASING RATE DOWNLOAD LINKS, CONDITIONALLY RENDERED BASED ON CONCEPT NOTE LANGUAGE-->
                        
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"> 
                            <apex:outputText style="font-weight:bold;" >{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c,'')}<br/></apex:outputText>  
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                            <apex:outputText style="font-weight:bold;" >{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Affected_Subpopulation_s__c,'')}</apex:outputText><br/>                  
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Submitted',true,false)}">
                            <apex:outputText ><br/><b>{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c,'')}</b><br/></apex:outputText>
                            Due to the lack of data, all country-components have been assigned an initial rating of "No" for increasing rates of infection.            
                        </apex:outputpanel>
                        <!--Insert nature of increasing rate of infection field-->                        
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized' && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Nature_of_Increasing_Rate__c,'')}</apex:outputText>&nbsp;                                     
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized' && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Nature_of_Increasing_Rate_of_Infection__c,'')}</apex:outputText>                 
                        <!--<apex:commandLink value="See data" style="color:#0088CC !important;"/>-->                                        
                   </td>
                   <td width="20%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">                      
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">+ 0% (of 5% possible)&nbsp;</apex:outputText>                       
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                      + {!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_Theoretical_Adjustment__c,'')}% (of %5 possible)</apex:outputText>
                   </td>
                   <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                       <td width="30%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">                          
                             <apex:outputPanel rendered="{!if(lstshare[0].HasEditAccess == true && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                 <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopupCNE}','Increasing_Rate_of_Infection');" value="Accept"/>
                                 <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Increasing_Rate_of_Infection');" value="Request Revision"/>
                                 <!--<apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold;" onclick="onClickSharingButton();return false;" value="Share"/>
                                 </apex:outputPanel>-->
                             </apex:outputPanel>                            
                       </td>
                       <td width="10%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">                   
                           <span class="label label-success" style="display:{!if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c != '' && lstIncreasingReatofInfection[0].Status__c != '','','none')};background:{!if(lstIncreasingReatofInfection.size>0 && (lstIncreasingReatofInfection[0].Status__c == 'Accepted' || lstIncreasingReatofInfection[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c == 'Update Requested','#FAA732',if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                               {!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Status__c,'')}
                           </span>                   
                       </td>
                   </apex:outputPanel>
                   <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                       <td width="10%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">
                           <apex:commandLink style="color:#0088CC !important;" rendered="{!if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Functional_Team_Comments__c != null && lstIncreasingReatofInfection[0].Functional_Team_Comments__c != '',true,false)}" value="View reviewer comments" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Increasing_Rate_of_Infection');"/>                                                      
                       </td>
                   </apex:outputPanel>                                     
                 </tr>
                 <tr style="background-color: #F9F9F9">
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;">
                         <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextRisk}','{!$Component.txthelpTextRisk}');"
                             onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextRisk}');" >
                             <h5><u>Risk</u>: Confirm Status</h5>
                          </apex:outputPanel>
                          <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextRisk" style="display:none;margin-top: 28px;">
                                <apex:outputText id="txthelpTextRisk" value="US $ 1 Million top-up per disease component will go to countries identified as having exceptionally high risk. Changes to risk status should only be made in exceptional circumstances."/>
                           </apex:outputpanel>
                           <br/>
                          <apex:commandLink value="See details/guidance" action="/servlet/servlet.FileDownload?file=015b0000000ZgKU" target="_blank" style="color:#0088CC !important;"/>
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;">
                         <!--Insert impact rating field -->                         
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}"><b>{!if(lstRisk.size>0,lstRisk[0].Initial_Qualifies_for_Risk_Mitigation__c,'')}</b>&nbsp;</apex:outputText>                         
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"><b>{!if(lstRisk.size>0,lstRisk[0].Qualifies_for_Risk_Mitigation__c,'')}</b></apex:outputText>                         
                         <br/>                          
                         <apex:commandLink value="Download data" action="http://ffp.statesindex.org/rankings-2013-sortable" target="_blank" style="color:#0088CC !important;"/>                         
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;"> 
                        <apex:outputText value="+ US $ "/>    
                         <apex:outputText value="{0,number,###,###,###}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                            <apex:param value="{!if(lstRisk.size>0,lstRisk[0].Initial_Risk_Adjustment__c,'')}"/>
                         </apex:outputText>   
                          <apex:outputText value="{0,number,###,###,###}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                            <apex:param value="{!if(lstRisk.size>0,lstRisk[0].Risk_Adjustment__c,'')}"/>
                         </apex:outputText>                                       
                        <!--<apex:outputfield value="{!lstRisk[0].Initial_Risk_Adjustment__c}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}"/>
                        <apex:outputfield value="{!lstRisk[0].Risk_Adjustment__c}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"/>-->
                        <apex:outputText value=" (of US $ 1,000,000 possible)"/>
                     </td>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                         <td width="20%" class="tdBorderStyle" style="vertical-align:middle">                             
                                 <apex:outputPanel rendered="{!if(lstshare[0].HasEditAccess == true && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopup}','Risk');" Value="Accept"/>
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Risk');" value="Request Revision"/>
                                     <!--<apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                                         <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold;" onclick="onClickSharingButton();return false;" value="Share"/>
                                     </apex:outputPanel>-->
                                 </apex:outputPanel>
                                                         
                         </td>                     
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">                        
                             <span class="label label-success" style="display:{!if(lstRisk.size>0 && lstRisk[0].Status__c != '' && lstRisk[0].Status__c != '','','none')};background:{!if(lstRisk.size>0 && (lstRisk[0].Status__c == 'Accepted' || lstRisk[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstRisk.size>0 && lstRisk[0].Status__c == 'Update Requested','#FAA732',if(lstRisk.size>0 && lstRisk[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                                 {!if(lstRisk.size>0,lstRisk[0].Status__c,'')}
                             </span>                        
                         </td>
                     </apex:outputPanel>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;">
                             <apex:commandLink value="View reviewer comments" style="color:#0088CC !important;" rendered="{!if(lstRisk.size>0 && lstRisk[0].Functional_Team_Comments__c != null && lstRisk[0].Functional_Team_Comments__c != '',true,false)}" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Risk');"/>                            
                         </td>   
                     </apex:outputPanel>        
                 </tr>           
                  <tr>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;border-bottom:1px solid #DDDDDD;border-left: 1px solid #DDDDDD !important;">
                         <h5>Total</h5>                      
                         <br/>                     
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                         
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;"> 
                          <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review' || objConceptNote.Performance_Impact_Rate_Risk_Stage__c == 'Submitted',true,false)}">
                              <apex:outputtext value="{!round(Concept_Note__c.Initial_P_I_IR_Theoretical_Adjustment__c,0)}% + US $ "/>                              
                              <apex:outputText value="{0,number,###,###,###}">
                                  <apex:param value="{!Concept_Note__c.Initial_Risk_Theoretical_Adjustment__c}"/>
                              </apex:outputText>                          
                          </apex:outputpanel>
                          <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">                          
                              <apex:outputPanel rendered="{!if(Concept_Note__c.Eligible_for_Rescaling__c == 'No',true,false)}">
                                  <apex:outputText >100%</apex:outputText><br/>
                                  <i>Note: Per SteerCo decision, significantly over allocated and over allocated components were not allowed to receive upward adjustments for performance, impact, increasing rates of infection or risk. As such, this component received 100% of the allocation computed by the Strategy and Policy team.</i>
                              </apex:outputPanel>
                              <apex:outputPanel rendered="{!if(Concept_Note__c.Eligible_for_Rescaling__c == 'Yes',true,false)}">                                  
                                  <apex:outputtext value="{!Concept_Note__c.Total_P_I_IR_R_Theoretical_Adjustment__c}"/>
                                  <!--<apex:outputText value="{0,number,###,###,###}">
                                      <apex:param value="{!Concept_Note__c.Risk_Adjustment__c}"/>
                                  </apex:outputText>-->
                              </apex:outputPanel>
                          </apex:outputpanel>                           
                     </td>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                         <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">                                                         
                             <apex:outputPanel >
                                 <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId && blnIsDisableSubmitAll == true,true,false)}" onclick="return cannotsubmitall()">                               
                                    <apex:outputtext styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;background-image: none;box-shadow: none;cursor: default;opacity: 0.65;" value="Submit All" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c != 'Finance Data Review',true,false)}"></apex:outputtext>
                                    <apex:outputtext styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;background-image: none;box-shadow: none;cursor: default;opacity: 0.65;" value="Submit" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c == 'Finance Data Review',true,false)}"></apex:outputtext>
                                 </apex:outputPanel>
                                 <apex:outputPanel rendered="{!if($User.Id != Concept_Note__c.CCM_new__r.OwnerId || blnIsDisableSubmitAll == true || objConceptNote.Performance_Impact_Rate_Risk_Stage__c == 'Submitted' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">
                                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" value="Submit All" onclick="return OpenPopup('{!$Component.tstpopupSubmitAll}','');" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c != 'Finance Data Review',true,false)}"/>
                                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" value="Submit" onclick="return OpenPopup('{!$Component.tstpopupSubmitAll}','');" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c == 'Finance Data Review',true,false)}"/>
                                 </apex:outputPanel>
                                 <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold !important;" onclick="onClickSharingButton();return false;" value="Share"/>
                                 </apex:outputPanel>
                            </apex:outputPanel>
                         </td>                     
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                            
                         </td>
                     </apex:outputPanel>
                     <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                         <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                         </td>   
                     </apex:outputPanel>
                 </tr>                   
                 <!--<tr>
                   <td>Risk</td>
                   <td>D <a href="#">more info <i class=" icon-question-sign"></i></a> </td>
                   <td><span class="badge badge-important">-10%</span></td>
                   <td><a href="#myModal" role="button" class="btn btn-danger" data-toggle="modal">Contest</a><button class="btn btn-mini btn-success" type="button">Accept</button></td>
                 </tr> -->             
               </tbody>
            </table>
         </div>
      </div>
   </div>
   </td>
  </tr>
   </apex:outputPanel>
   
   <!--Panel that renders if the PIIRR stage is LFA Performance Update Review-->
    
    <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}">    
   <tr>
   <td style="vertical-align:top">
      <div class="span2">
       <div class="task_summary border">
         <br/><br/>
         <div class="number">
           <div class="label label-info">  
           <h6>Deadline</h6><br/>
           <apex:outputPanel styleclass="label label-info" style="background:#FA5858 !important;" rendered="{!if(Concept_Note__c.LFA_Verified_Performance_Deadline__c != null,true,false)}">
               <apex:outputField value="{!Concept_Note__c.LFA_Verified_Performance_Deadline__c}"/>
           </apex:outputPanel>
           </div>
           <br/><br/>
           <div class="label label-info">
           <h6>Status</h6> <br/>
           <!--<apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized'
                                       && lstImpact.Size > 0 && lstPerformance.Size > 0 && lstIncreasingReatofInfection.Size > 0,true,false)}">
               <span class="label label-info">
                   {!strStatusImpactPerformance }
               </span>
           </apex:outputPanel>-->
           <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}">
               <span class="label label-info" style="background:{!if(objConceptNote.LFA_Verified_Performance_Status__c == 'Data Finalized' || objConceptNote.LFA_Verified_Performance_Status__c == 'Accepted','#5BB75B',if(objConceptNote.LFA_Verified_Performance_Status__c == 'Under Review','#2E9AFE',if(objConceptNote.LFA_Verified_Performance_Status__c == 'Update Requested','#FAA732','')))} !important;">
                   {!objConceptNote.LFA_Verified_Performance_Status__c}
               </span>
           </apex:outputPanel>
           </div>
          </div>
       </div>
     </div>
    </td>
    <td>
     <div class="span10">
      <div class="task border">
        <div class="task_details ">
          <h3>Performance, Impact, Increasing Rate of Infection, and Risk</h3>
          <div class="">               
          </div>
        </div>        
        <div class="task_workspace">
           <table id="QC_table" cellspacing="0" cellpadding="0" style="border-collapse: separate !important;" class="table table-striped">
             <col width="200px" />
             <col width="200px" />
             <col/>
             <col width="200px"/>
             <col/>
             <col/>
             <thead>
               <tr>
                 <th width="20%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Factor</th>
                 <th width="20%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Rating</th>
                 <th width="35%" style="font-weight:normal !important;background:#2492B9;border-right: solid 1px #DDDDDD">
                     <!--<a href="#" style="color:#ffffff !important;"> <u>Theoretical adjustment</u></a>-->
                     <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextAdjustmentLFA}','{!$Component.txthelpTextAdjustmentLFA}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextAdjustmentLFA}');">
                      
                     <h5><u style="color:#ffffff;"><font style="color:#ffffff;font-weight:bold;font-size:14px;">Theoretical adjustment</font></u></h5>
                     </apex:outputPanel>
                     <apex:outputpanel styleClass="helpTextAdjustment" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextAdjustmentLFA}','{!$Component.txthelpTextAdjustmentLFA}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextAdjustmentLFA}');" id="ophelpTextAdjustmentLFA" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextAdjustmentLFA">
                               Adjustments for qualitative factors are first made on a theoretical basis to 
                                <br/>give a percentage of the initial disease component allocations. Following 
                                <br/>these adjustments, all components in a band (the group of countries a  
                                <br/>component falls into based on its disease burden and ability to pay) need  
                                <br/>to be rescaled so that the total allocations to components in a  band 
                                <br/>equals the total amount of funds available in the band. As such, actual 
                                <br/>adjustments will not likely be exactly equal to the theoretical adjustment.<br/>
                                <a href="#" style="color:#0088CC !important;"> See detailed description document for more information</a>
                            </apex:outputtext>
                     </apex:outputpanel>
                 </th>                 
                 <th width="20%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Action</th>                 
                 <th width="10%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Status</th>                 
                 <th  width="10%" style="background:#2492B9;color:#ffffff;font-weight:bold;font-size:14px; !important">Reviewer comments</th>                 
               </tr>
             </thead>
               <tbody>
                <tr>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;">                      
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextBaseLineLFA}','{!$Component.txthelpTextBaseLineLFA}');"
                         onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextBaseLineLFA}');" >
                         <h5><u>Baseline</u></h5>     
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextBaseLineLFA" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextBaseLineLFA"> For qualitative factors, disease component allocations are reduced to 70% of the level indicated by the allocation formula (after external financing and MRL taken into account).Then, starting at 70%, components are allocated adjustments based on Performance, Impact and Increasing Rates of Infection </apex:outputtext>
                        </apex:outputpanel>
                        <br/>                     
                    </td>
                    <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">                     
                    </td>
                    <td style="vertical-align:middle;" class="tdBorderStyle" width="20%">  
                        70%                                   
                    </td>                   
                    <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                    </td>
                    <td width="10%" style="vertical-align:middle;" class="tdBorderStyle">                                          
                    </td>                   
                    <td class="tdBorderStyle" style="vertical-align:middle;" width="10%"></td>                   
                 </tr>
                 <tr>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;border-left: 1px solid #DDDDDD !important;">
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextPerformanceLFA}','{!$Component.txthelpTextPerformanceLFA}');"
                         onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextPerformanceLFA}');" >
                         <h5><u>Performance</u>: Confirm Rating</h5>
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextPerformanceLFA" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextPerformanceLFA" value="Performance is the weighted average, indicator-based performance of all past grants over the last 24 months that would apply to a particular disease component."/>
                        </apex:outputpanel>
                        <br/>
                    <apex:commandLink value="See details/guidance" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000ZgKF"/> 
                    </td>
                    <td width="20%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">
                        <apex:outputText >
                            <b>{!if(lstPerformance.size>0,lstPerformance[0].LFA_Verified_Performance_Rating__c,'')}</b>
                        </apex:outputText>                                          
                       
                        <br/>                     
                        <apex:commandLink value="Download data" action="/servlet/servlet.FileDownload?file=015b0000000ZgKP" target="_blank" style="color:#0088CC !important;"/>
                        <apex:outputText >
                        <br>Please save file before opening</br>
                        </apex:outputText>                      
                    </td>
                    <td style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle" width="20%">  
                        <apex:outputText >
                            +{!if(lstPerformance.size>0, lstPerformance[0].Initial_Performance_Theoretical_Adjust__c,'')}% (of 25% possible)
                        </apex:outputText>                                                     
                    </td>                    
                    <td width="20%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">
                        <apex:outputpanel rendered="{!lstshare[0].HasEditAccess}">
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;" onclick="return OpenPopup('{!$Component.tstpopup}','Performance');" value="Accept"/>
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Performance');" value="Request Revision"/>
                            <!--<apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                                <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;" onclick="onClickSharingButton();return false;" value="Share"/>
                            </apex:outputPanel>-->
                        </apex:outputpanel>                                    
                    </td>
                    <td width="10%" style="vertical-align:middle;border-top-color:#000000 !important;" class="tdBorderStyle">                       
                        <span class="label label-success" style="display:{!if(lstPerformance.size>0 && lstPerformance[0].Status__c != '' && lstPerformance[0].Status__c != '','','none')};background:{!if(lstPerformance.size>0 && (lstPerformance[0].Status__c == 'Accepted' || lstPerformance[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstPerformance.size>0 && lstPerformance[0].Status__c == 'Update Requested','#FAA732',if(lstPerformance.size>0 && lstPerformance[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">{!if(lstPerformance.size>0,lstPerformance[0].Status__c,'')}
                        </span> 
                    </td>                   
                    <td class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;" width="10%">
                        <apex:commandLink style="color:#0088CC !important;" value="View reviewer comments" rendered="{!if(lstPerformance.size>0 && (lstPerformance[0].Functional_Team_Comments__c != null && lstPerformance[0].Functional_Team_Comments__c != ''),true,false)}"  onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Performance');" />                        
                    </td>                   
                 </tr>
                 <tr style="background-color: #F9F9F9">
                     <td width="20%" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;" class="tdBorderStyle">
                         <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextImapctLFA}','{!$Component.txthelpTextImpactLFA}');"
                             onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextImapctLFA}');" >
                             <h5><u>Impact</u>: Confirm Rating</h5>
                         </apex:outputPanel>
                         <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextImapctLFA" style="display:none;margin-top: 28px;">
                                <apex:outputText id="txthelpTextImpactLFA" value="Impact is defined as progress made by programs in reducing mortality and morbidity of three diseases to meet the 2015 MDGs 6/international targets."/>
                         </apex:outputpanel>
                         <br/>
                         <apex:commandLink value="See details/guidance" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000ZgLN"/>
                     </td>
                     <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                         <!--Insert impact rating field -->                         
                         <apex:outputText ><b>{!if(lstImpact.size>0,lstImpact[0].Initial_Impact_Rating__c,'')}</b></apex:outputText>
                         
                         <!--<apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"><b>{!if(lstImpact.size>0,lstImpact[0].Impact_Rating__c,'')}</b></apex:outputText>-->                        
                         <br/>                          
                         <apex:commandLink style="color:#0088CC !important;" value="Download data" action="/servlet/servlet.FileDownload?file=015b0000000ZgKe" target="_blank"/>
                         <apex:outputText >
                        <br>Please save file before opening</br>
                        </apex:outputText>                         
                     </td>
                     <td width="20%" style="vertical-align:middle;" class="tdBorderStyle">
                      <apex:outputpanel rendered = "{!if(lstPerformance.size>0 && (lstPerformance[0].Initial_Performance_Rating__c == 'C' || lstPerformance[0].Performance_Rating__c == 'C') ,false,true)}">                       
                           <apex:outputText >
                               +{!if(lstImpact.size>0, lstImpact[0].Initial_Impact_Theoretical_Adjustment__c,'')}% (of 15% possible)
                           </apex:outputText>                           
                      </apex:outputpanel>
                      <apex:outputpanel rendered = "{!if(lstPerformance.size>0 && (lstPerformance[0].Initial_Performance_Rating__c == 'C' || lstPerformance[0].Performance_Rating__c == 'C') ,true,false)}">
                          Countries with a performance rating of “C” for a given component are ineligible for an impact adjustment. 
                      </apex:outputpanel>      
                     </td>                     
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;">                                         
                     </td>                     
                     <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">                        
                         <span class="label label-success" style="display:{!if(lstImpact.size>0 && lstImpact[0].Status__c != '' && lstImpact[0].Status__c != '','','none')};background:{!if(lstImpact.size>0 && (lstImpact[0].Status__c == 'Accepted' || lstImpact[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstImpact.size>0 && lstImpact[0].Status__c == 'Update Requested','#FAA732',if(lstImpact.size>0 && lstImpact[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                             {!if(lstImpact.size>0,lstImpact[0].Status__c,'')}
                         </span>                        
                     </td>                     
                     <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">
                         <apex:commandLink style="color:#0088CC !important;" rendered="{!if(lstImpact.size>0 && (lstImpact[0].Functional_Team_Comments__c != null && lstImpact[0].Functional_Team_Comments__c != ''),true,false)}"  value="View reviewer comments" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Impact');"/>                         
                     </td>                        
                 </tr>           
                 <tr>
                    <td width="20%" style="vertical-align:middle;background:#ffffff !important;border-left: 1px solid #DDDDDD !important;" class="tdBorderStyle">
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextIRILFA}','{!$Component.txthelpTextIRILFA}');"
                             onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextIRILFA}');" >
                             <h5><u>Increasing rate of infection</u>: Provide Additional Data</h5>
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextIRILFA" style="display:none;margin-top: 28px;">
                                <apex:outputText id="txthelpTextIRILFA" value="An Increasing Rate of Infection is defined as an emerging or resurging infection in HIV, TB or malaria due to a funding gap. Due to a lack of partner data, CTs are encouraged to upload any existing data they know about, if necessary, reaching out to CCMs."/>
                        </apex:outputpanel> 
                        <br/>
                        <apex:commandLink value="See details/guidance" action="/servlet/servlet.FileDownload?file=015b0000000ZgL3" target="_blank" style="color:#0088CC !important;"/>
                        <br/> <br/>
                        <apex:outputtext value="See below links for letters to send to CCMs (if desired) and excel template for submitting data:" style="font-size:85%"/><br/> 
                        <a href="/servlet/servlet.FileDownload?file=015b0000000ZgK0" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}" style="color:#0088CC !important;">Letter to CCM (En)</a><br/>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'SPANISH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlX0" style="color:#0088CC !important;" value="Letter to CCM (Es)"/><br/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'FRENCH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlWq" style="color:#0088CC !important;" value="Letter to CCM (Fr)"/><br/>
                        </apex:outputpanel>
                         <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'PORTUGUESE',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlWv" style="color:#0088CC !important;" value="Letter to CCM (Pt)"/><br/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'RUSSIAN',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlXv" style="color:#0088CC !important;" value="Letter to CCM (Rs)"/><br/>
                        </apex:outputpanel> 
                        <a href="/servlet/servlet.FileDownload?file=015b0000000ZgKo" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}" style="color:#0088CC !important;">Excel Template (En)</a><br/>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'SPANISH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYs" style="color:#0088CC !important;" value="Excel Template (Es)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'FRENCH',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYh" style="color:#0088CC !important;" value="Excel Template (Fr)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'PORTUGUESE',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYc" style="color:#0088CC !important;" value="Excel Template (Pt)"/>
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Language__c != 'RUSSIAN',false,if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false))}">
                            <apex:commandlink action="/servlet/servlet.FileDownload?file=015b0000000ZlYx" style="color:#0088CC !important;" value="Excel Template (Rs)"/>
                        </apex:outputpanel>                                                    
                    </td>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">
                         <apex:inputHidden value="{!Concept_Note__c.Language__c}"/>
                        <!--Insert increasing rate of infection field -->
                        
           <!--LFA INCREASING RATE DOWNLOAD LINKS, CONDITIONALLY RENDERED BASED ON CONCEPT NOTE LANGUAGE-->
                        
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"> 
                            <apex:outputText style="font-weight:bold;" >{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c,'')}<br/></apex:outputText>  
                        </apex:outputpanel>
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                            <apex:outputText style="font-weight:bold;" >{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Affected_Subpopulation_s__c,'')}</apex:outputText><br/>                  
                        </apex:outputpanel>
                        
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}">
                            <apex:outputText ><br/><b>{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c,'')}</b><br/></apex:outputText>
                            Due to the lack of data, all country-components have been assigned an initial rating of "No" for increasing rates of infection.            
                        </apex:outputpanel> 
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized' && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Nature_of_Increasing_Rate__c,'')}</apex:outputText>&nbsp;                                     
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized' && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Nature_of_Increasing_Rate_of_Infection__c,'')}</apex:outputText>
                        <!--<apex:outputText rendered="{!if(Concept_Note__c.P_I_IR_Ready_for_Review__c == true && Concept_Note__c.Absorptive_Capacity_Ready_for_Review__c == false,true,false)}">Data for Increasing Rates of Infection is being provided by CCMs.  This section is for Country Teams to upload this data and a narrative description if it has been provided.</apex:outputText> &nbsp;
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c,'')}<br/></apex:outputText> 
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Affected_Subpopulation_s__c,'')}</apex:outputText><br/>              
                         <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Review',true,false)}">
                            <apex:outputText ><br/>{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c,'')}<br/></apex:outputText>
                            <a href="#" style="color:#0088CC !important;">Due to the lack of data, all country-components have been assigned an initial rating of "No" for increasing rates of infection.</a>            
                        </apex:outputpanel>-->
                        <!--Insert nature of increasing rate of infection field-->     
                       <!-- <apex:outputText rendered="{!if(Concept_Note__c.P_I_IR_Ready_for_Review__c == true && Concept_Note__c.Absorptive_Capacity_Ready_for_Review__c == false && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Initial_Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Nature_of_Increasing_Rate__c,'')}</apex:outputText>&nbsp;                                     
                        <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized' && lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Increasing_Rate_of_Infection__c = 'Yes',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Nature_of_Increasing_Rate_of_Infection__c,'')}</apex:outputText>-->
                                   
                        <!--<apex:commandLink value="See data" style="color:#0088CC !important;"/>-->                                        
                    </td>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">
                       <!--<apex:outputText rendered="{!if(Concept_Note__c.P_I_IR_Ready_for_Review__c == true && Concept_Note__c.Absorptive_Capacity_Ready_for_Review__c == false,true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Initial_Increasing_Rate_Adjustment__c,'')}%</apex:outputText>-->
                       <!--<apex:outputText rendered="{!if(Concept_Note__c.P_I_IR_Ready_for_Review__c == true && Concept_Note__c.Absorptive_Capacity_Ready_for_Review__c == false,true,false)}">0%</apex:outputText>
                       &nbsp;
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">{!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_Theoretical_Adjustment__c,'')}%</apex:outputText>-->
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">+ 0% (of 5% possible)</apex:outputText>
                       &nbsp;
                       <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                          + {!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Increasing_Rate_Theoretical_Adjustment__c,'')}% (of %5 possible)</apex:outputText>
                    </td>  
                    <td width="30%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">                        
                    </td>
                    <td width="10%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">                   
                       <span class="label label-success" style="display:{!if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c != '' && lstIncreasingReatofInfection[0].Status__c != '','','none')};background:{!if(lstIncreasingReatofInfection.size>0 && (lstIncreasingReatofInfection[0].Status__c == 'Accepted' || lstIncreasingReatofInfection[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c == 'Update Requested','#FAA732',if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                           {!if(lstIncreasingReatofInfection.size>0,lstIncreasingReatofInfection[0].Status__c,'')}
                       </span>                 
                    </td>     
                   <td width="10%" class="tdBorderStyle" style="vertical-align:middle;background:#ffffff !important;">
                       <apex:commandLink style="color:#0088CC !important;" rendered="{!if(lstIncreasingReatofInfection.size>0 && lstIncreasingReatofInfection[0].Functional_Team_Comments__c != null && lstIncreasingReatofInfection[0].Functional_Team_Comments__c != '',true,false)}" value="View reviewer comments" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Increasing_Rate_of_Infection');"/>
                    </td>                   
                 </tr>
                 <tr style="background-color: #F9F9F9">
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-left: 1px solid #DDDDDD !important;">
                        <apex:outputPanel style="cursor:pointer !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextRiskLFA}','{!$Component.txthelpTextRiskLFA}');"
                        onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextRiskLFA}');" >
                            <h5><u>Risk</u>: Confirm Status</h5>
                        </apex:outputPanel>
                        <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextRiskLFA" style="display:none;margin-top: 28px;">
                            <apex:outputText id="txthelpTextRiskLFA" value="US $ 1 Million top-up per disease component will go to countries identified as having exceptionally high risk. Changes to risk status should only be made in exceptional circumstances."/>
                        </apex:outputpanel>
                        <br/>
                        <apex:commandLink value="See details/guidance" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000ZgKU"/>
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;">
                         <!--Insert impact rating field -->                         
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                             <b>{!if(lstRisk.size>0,lstRisk[0].Initial_Qualifies_for_Risk_Mitigation__c,'')}</b>&nbsp;
                         </apex:outputText>
                         
                         <apex:outputText rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"><b>{!if(lstRisk.size>0,lstRisk[0].Qualifies_for_Risk_Mitigation__c,'')}</b></apex:outputText>                         
                         <br/>                          
                         <apex:commandLink value="Download data" style="color:#0088CC !important;" action="http://ffp.statesindex.org/rankings-2013-sortable"/>                         
                     </td>
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle;"> 
                        <apex:outputText value="US $ "/>
                         <apex:outputText value="{0,number,###,###,###}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                            <apex:param value="{!if(lstRisk.size>0,lstRisk[0].Initial_Risk_Adjustment__c,'')}"/>
                         </apex:outputText>   
                          <apex:outputText value="{0,number,###,###,###}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                            <apex:param value="{!if(lstRisk.size>0,lstRisk[0].Risk_Adjustment__c,'')}"/>
                         </apex:outputText> 
                        <!--<apex:outputfield value="{!lstRisk[0].Initial_Risk_Adjustment__c}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}"/>                                                   
                        <apex:outputfield value="{!lstRisk[0].Risk_Adjustment__c}" rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}"/>-->
                        <!--<apex:outputText value="{0,number,###,###,###}" rendered="{!if(lstRisk.size>0 && (lstRisk[0].Initial_Qualifies_for_Risk_Mitigation__c == 'Yes' || lstRisk[0].Qualifies_for_Risk_Mitigation__c == 'Yes'),true,false)}">
                           <apex:param value=""/>
                        </apex:outputText>--> 
                     </td>                     
                     <td width="20%" class="tdBorderStyle" style="vertical-align:middle">                        
                     </td>                     
                     <td width="10%" class="tdBorderStyle" style="vertical-align:middle;">                        
                         <span class="label label-success" style="display:{!if(lstRisk.size>0 && lstRisk[0].Status__c != '' && lstRisk[0].Status__c != '','','none')};background:{!if(lstRisk.size>0 && (lstRisk[0].Status__c == 'Accepted' || lstRisk[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstRisk.size>0 && lstRisk[0].Status__c == 'Update Requested','#FAA732',if(lstRisk.size>0 && lstRisk[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                             {!if(lstRisk.size>0,lstRisk[0].Status__c,'')}
                         </span>                        
                     </td>                     
                     <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;">
                         <apex:commandLink value="View reviewer comments" style="color:#0088CC !important;" rendered="{!if(lstRisk.size>0 && lstRisk[0].Functional_Team_Comments__c != null && lstRisk[0].Functional_Team_Comments__c != '',true,false)}" onclick="return OpenPopupFunctionalTeam('{!$Component.tstpopupFunctionalTeam}','Risk');"/>                       
                     </td>   
                 </tr>           
                 <tr>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-top-color:#000000 !important;border-bottom:1px solid #DDDDDD;border-left: 1px solid #DDDDDD !important;">
                         <h5>Total</h5>                      
                    <br/>                     
                    </td>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                    </td>
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;"> 
                        <apex:outputpanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'LFA Performance Update Review',true,false)}">
                              <apex:outputtext value="{!round(Concept_Note__c.LFA_P_I_IR_Theoretical_Adjustment__c,0)}% + US $ "/>                              
                              <apex:outputText value="{0,number,###,###,###}">
                                  <apex:param value="{!Concept_Note__c.Initial_Risk_Theoretical_Adjustment__c}"/>
                              </apex:outputText>
                        </apex:outputpanel>                                                
                    </td>                     
                    <td width="20%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                         <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                             <apex:outputPanel rendered="{!if(blnIsDisableSubmitAll == true,true,false)}">
                               <apex:outputtext styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;background-image: none;box-shadow: none;cursor: default;opacity: 0.65;" value="Submit" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c == 'Finance Data Review',true,false)}"></apex:outputtext>
                               <apex:outputtext styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;background-image: none;box-shadow: none;cursor: default;opacity: 0.65;" value="Submit All" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c != 'Finance Data Review',true,false)}"></apex:outputtext>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!if($User.Id != Concept_Note__c.CCM_new__r.OwnerId || blnIsDisableSubmitAll == true || objConceptNote.Performance_Impact_Rate_Risk_Stage__c == 'Submitted' || Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',false,true)}">                                                     
                                <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopupSubmitAll}','');" value="Submit" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c == 'Finance Data Review',true,false)}"/>
                                <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopupSubmitAll}','');" value="Submit All" rendered="{!if(objConceptNote.Absorptive_Capacity_Stage__c == 'Finance Data Review',false,true)}"/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId && objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted' && Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c != 'Finalized',true,false)}">
                                 <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold !important;" onclick="onClickSharingButton();return false;" value="Share"/>
                             </apex:outputPanel>
                         </apex:outputPanel>
                    </td>                     
                    <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">                        
                    </td>                     
                    <td width="10%" class="tdBorderStyle" style="vertical-align:middle;border-bottom:1px solid #DDDDDD;border-top-color:#000000 !important;">
                    </td>                        
                 </tr>                   
                 <!--<tr>
                   <td>Risk</td>
                   <td>D <a href="#">more info <i class=" icon-question-sign"></i></a> </td>
                   <td><span class="badge badge-important">-10%</span></td>
                   <td><a href="#myModal" role="button" class="btn btn-danger" data-toggle="modal">Contest</a><button class="btn btn-mini btn-success" type="button">Accept</button></td>
                 </tr> -->             
               </tbody>
            </table>
         </div>
      </div>
   </div>
   </td>
   </tr>
   </apex:outputPanel>
   <!--<div class="span2">
     <div class="task_summary border">
       <div class="number">        
       </div>
     </div>
   </div> <br/>
   
   <div class="span10">
      <div class="task border">
        <div class="task_details ">         
          <div class="">          
          </div>
        </div>  
        <div class="task_workspace">
           <h4>Adjusted share after performance and impact and increasing rates of infection adjustments</h4>
           <p>Your preliminary allocation amount and theoretical adjustment are shown below. Please note that these figures are not final and will be adjusted due to rescaling and absorptive capacity.</p> 
           <table class="table table-striped">
             <tr>
             <td> <span class="badge">1</span> Initial country share computed by the Strategy and Policy team, excluding WTP</td>
             <td>
                    "US $ {!Concept_Note__c.NFA__c}"   
             </td>
             </tr>
             <tr>
               <td><span class="badge">2</span> Initial country share adjusted for performance, impact, and increasing rates of infection, prior to rescaling</td>
               <td>{!Concept_Note__c.P_I_IR_Theoretical_Allocation__c} Million</td>
             </tr>             
           </table>           
            <div class="pull_right">
            </div>           
           </div>
         </div>
      </div>-->
  <tr>
   <td style="vertical-align:top">  
    <div class="span2">
     <div class="task_summary border">
       <br/><br/>
       <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c != 'Pre-Release' && Concept_Note__c.Absorptive_Capacity_Stage__c != '',true,false)}">
       <div class="number">
         <div class="label label-info">  
             <h6>Deadline</h6><br/>
             <apex:outputPanel styleclass="label label-info" style="background:#FA5858 !important;" rendered="{!if(Concept_Note__c.Absorptive_Capacity_Review_Deadline__c != null,true,false)}">
                 <apex:outputField value="{!Concept_Note__c.Absorptive_Capacity_Review_Deadline__c}"/>
             </apex:outputPanel>
             <br/>
         </div> <br/> <br/>
         <div class="label label-info">
         <h6>Status</h6> <br/>
         <!--<apex:outputPanel rendered="{!If(Concept_Note__c.Final_Allocation_Ready_for_Review__c == true &&
                                     lstAbsorptiveCapacity.size > 0 && lstRisk.Size > 0,true,false)}">
             <span class="label label-warning">
                 {!strStatusAbsorptiveCapacity}
             </span>
         </apex:outputPanel>-->
         <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c != 'Pre-Release' && Concept_Note__c.Absorptive_Capacity_Stage__c != 'Absorptive Capacity Review' && Concept_Note__c.Absorptive_Capacity_Stage__c != 'No Review Required' && Concept_Note__c.Absorptive_Capacity_Stage__c != '',true,false)}">
               <span class="label label-info" style="background:{!if(objConceptNote.Absorptive_Capacity_Initial_Alloc_Status__c == 'Data Finalized' || objConceptNote.Absorptive_Capacity_Initial_Alloc_Status__c == 'Accepted','#5BB75B',if(objConceptNote.Absorptive_Capacity_Initial_Alloc_Status__c == 'Under Review','#2E9AFE',if(objConceptNote.Absorptive_Capacity_Initial_Alloc_Status__c == 'Update Requested','#FAA732','')))} !important;">
                   {!objConceptNote.Absorptive_Capacity_Initial_Alloc_Status__c}
               </span>
           </apex:outputPanel>
           <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c = 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c = 'No Review Required',true,false)}">
               <span class="label label-info" style="background:{!if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Data Finalized' || objConceptNote.Absorptive_Capacity_Review_Status__c == 'Accepted' ,'#5BB75B',if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Under Review','#2E9AFE',if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Update Requested','#FAA732',if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Submitted','#FA5858',''))))} !important;">
                   {!objConceptNote.Absorptive_Capacity_Review_Status__c}
               </span>
           </apex:outputPanel>
         </div>
       </div>
        </apex:outputPanel>
     </div>
   </div>
   </td>
   <td>  
    <div class="span10">
      <div class="task border">
      <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c != 'Pre-Release' && Concept_Note__c.Absorptive_Capacity_Stage__c != '',true,false)}">
        <div class="task_details ">
                 <apex:outputPanel style="cursor:pointer !important;color:#0088CC !important;" onmouseover="onMouseOverHelpTextShow('{!$Component.ophelpTextAC}','{!$Component.txthelpTextAC}');"
                     onmouseout="onMouseOutHelpTextHide('{!$Component.ophelpTextAC}');" >
                    <br/><h3><u>Absorptive Capacity Review and Other Considerations</u></h3>
                 </apex:outputPanel>
                 <apex:outputpanel styleClass="helpTextPopup" id="ophelpTextAC" style="display:none;margin-top: 28px;">
                        <apex:outputText id="txthelpTextAC" value="Absorptive Capacity is the forecasted ability of the country or PR to disburse aid and use it effectively. Country teams are asked to review absorptive capacity two times. First, they are asked to review the financial data below and note any factual errors. Second, once any factual errors in data are corrected and inputs from Performance, Impact, Increasing Rates of Infection, and Risk are submitted and reviewed, Country Teams will be able to see a proposed allocation amount and, if required, review it for absorptive capacity."/>
                 </apex:outputpanel>                          
           <a href="/servlet/servlet.FileDownload?file=015b0000000ZvNA" style="color:#0088CC !important;margin-left:20px;">See details/guidance</a><br/>       
          </div>
           </apex:outputPanel>
           <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c != 'Absorptive Capacity Review' && Concept_Note__c.Absorptive_Capacity_Stage__c != 'No Review Required' && Concept_Note__c.Absorptive_Capacity_Stage__c != 'Pre-Release',true,false)}">
          <div class="">
            <p>The country-component's EFR data are displayed below. Please review the data and either indicate acceptance or request a revision. If you request a revision, you will be asked to provide a justification.</p> <br/>          
          </div>
      </apex:outputPanel>
      <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c = 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c = 'No Review Required',true,false)}">
          <div class="">
            <p><br></br>The preliminary allocations for this country-component, adjusted for qualitative factors and rescaled to reflect the country-component's relative amount of funding in its band, are displayed below.</p> <br/>          
          </div>
      </apex:outputPanel>
         
         <div class="task_workspace">
           <table class="table table-striped" width="80%">
             <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c == 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c == 'No Review Required',true,false)}">
             <tr>
                 <th colspan="2" class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#336699">
                   <center><h4>Information about the Preliminary Allocation to be Reviewed</h4></center>
                 </th>
             </tr> 
             <tr>
                 <th colspan="2" class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
                   <h4>Preliminary Allocation</h4>
                 </th>
             </tr>
              <tr>
                 <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                     <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextFSA}','{!$Component.txthelpTextFSA}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextFSA}');">                      
                            <u>Fair Share Amount:</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextFSA" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextFSA" style="font-weight:normal !important;color:#000000 !important;" >
                               The "Fair Share" amount represents the amount of funding calculated based on disease burden, ability to pay and external financing.</apex:outputtext>
                     </apex:outputpanel>                     
                     Allocation based on disease burden and ability to pay</td>
                 <td class="tdBorderStyle">                    
                     <apex:outputtext value="US $ ">
                     </apex:outputText>
                     <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.Pre_MRL__c}"/> 
                     </apex:outputText>                  
                 </td>        
             </tr>  
              <tr>
                 <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                 <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextNFA}','{!$Component.txthelpTextNFA}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextNFA}');">                      
                        <u>Notional Funding Amount:</u>
                  </apex:outputPanel>                      
                 <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextNFA" style="display:none;margin-top: 25px;left:12% !important;">
                        <apex:outputText id="txthelpTextNFA" style="font-weight:normal !important;color:#000000 !important;" >
                           The Notional Funding Amount represents the amount adjusted once all components have been adjusted for their MRL (the higher of their existing pipeline of funding or past four years - 2010-2013 - disbursement * 75%).</apex:outputtext>
                 </apex:outputpanel>  
                 Allocation adjusted for the Minimum Required Level (MRL) before qualitative factors</td>
                 <td class="tdBorderStyle">                    
                     <apex:outputtext value="US $ ">
                     </apex:outputText>
                     <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.NFA__c}"/> 
                     </apex:outputText>                  
                 </td>        
             </tr>   
             <tr>
                 <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                  <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextOUS}','{!$Component.txthelpTextOUS}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextOUS}');">                      
                        <u>Over / under allocation status:</u>
                  </apex:outputPanel>                      
                 <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextOUS" style="display:none;margin-top: 25px;left:12% !important;">
                        <apex:outputText id="txthelpTextOUS" style="font-weight:normal !important;color:#000000 !important;" >
                           Components can be categorized as over or under allocated based on the relationship between the Notional Funding Amount and the Fair Share amount. 
                          Over allocated components are those which had MRLs higher than the Fair Share amount, and as such had to be adjusted above their Fair Shares.  Under allocated components are those that had MRLs lower than their Fair Share amount,
                          and as such were adjusted downwards to allow the over allocated components to be adjusted upwards.</apex:outputtext>
                 </apex:outputpanel> (Based on Notional Funding Amount vs. Fair Share)</td>
                 <td class="tdBorderStyle">                    
                     <apex:outputText value="{!Concept_Note__c.Allocation_Status__c}">                    
                     </apex:outputText>                  
                 </td>        
             </tr>        
              <tr>
                 <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                     <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextPOU}','{!$Component.txthelpTextPOU}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextPOU}');">                      
                            <u>Percent over / under allocated:</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextPOU" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextPOU" style="font-weight:normal !important;color:#000000 !important;" >
                                This represents the extent to which a component is under or over allocated.  It is calculated as Notional Funding Amount / Fair Share Amount.  
                                Components where this ratio is greater than 150% are categorized as Significantly Over Allocated.  
                                Components with a ratio of 110-150% are categorized as Over Allocated. 
                                Components with a ratio of 90-110% are categorized as Appropriately Allocated.  And, components with a ratio of less than 90% are categorized as Under Allocated.</apex:outputtext>
                     </apex:outputpanel>
                    Notional Funding Amount as % of Fair Share (amount of over / under allocation)</td>
                 <td class="tdBorderStyle">                    

                     <apex:outputText value="{0,number,###,###,###}%">
                     <apex:param value="{!Concept_Note__c.NFA_as_of_Fair_Share__c}"/> 
                     </apex:outputText>                  
                 </td>        
             </tr>            
             <!--<tr>                 
                 <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                   Allocation adjusted for performance, impact, increasing rates of infection, and risk qualitative factors
                   <apex:outputPanel rendered="{!if((Concept_Note__c.Allocation_Status__c =='Significantly Overallocated' || Concept_Note__c.Allocation_Status__c =='Overallocated') && (Concept_Note__c.Theoretical_Adjustment_Sum__c >= 100 || Concept_Note__c.NFA__c == Concept_Note__c.Existing_Funding__c),true,false)}">
                       <br/><br/><i>Note: Per SteerCo decision, over allocated components (i.e. those receiving more than their "fair share" of funding) were not allowed to receive upward adjustments for performance, impact, increasing rates of infection or risk. Additionally, over allocated components that receive only their existing funding are not adjusted for performance, impact, increasing rates of infection or risk. Because this component fell into one of these two categories, it received 100% of the allocation computed by the formula, regardless of perfromance, impact, increasing rates of infection, and risk.</i>                        
                   </apex:outputPanel>
                </td>
                 <td class="tdBorderStyle">
                     <apex:outputtext value="US $ ">
                     </apex:outputText>
                     <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.P_I_IR_Risk_Adjusted_Allocation__c}"/> 
                     </apex:outputText>
                 </td>        
             </tr>-->             
             <tr>               
               <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                   <b>
                   <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextAR}','{!$Component.txthelpTextAR}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextAR}');">                      
                            <u>Allocation for Review:</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextAR" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextAR" style="font-weight:normal !important;color:#000000 !important;" >
                                This is the number for the country team to review.  It is the Notional Funding Amount after rescaling the adjustments for Performance, Impact, Increasing Rates of Infection and Risk Qualitative Factors.  Note that Significantly Over Allocated and Over Allocated components were not allowed to be adjusted upwards for these factors.</apex:outputtext>
                     </apex:outputpanel>  
                     Allocation after rescaling adjustments for Performance, Impact, Increasing Rates and Risk</b>
                </td>
               <td class="tdBorderStyle">     
                     <b><apex:outputtext value="US $ ">
                         </apex:outputText>
                         <apex:outputText value="{0,number,###,###,###}">
                          <apex:param value="{!Concept_Note__c.Final_Allocation__c}"/> 
                      </apex:outputText></b>
                 </td>
             </tr>
             <tr>
                 <th colspan="2" class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
                   <h4>Absorptive Capacity Data</h4>
                 </th>
            </tr>
             <tr>
                <td width="60%" class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;vertical-align:middle">                    
                 <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextPastAvg}','{!$Component.txthelpTextPastAvg}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextPastAvg}');">                      
                        <u>Past average annual spend</u>
                  </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextPastAvg" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextPastAvg" style="font-weight:normal !important;color:#000000 !important;" >
                        This is the average annual spend based on past EFR data. The numbers have been validated already by country teams and Program Finance.</apex:outputtext>
                     </apex:outputpanel>  
                 </td>
                <td width="20%" class="tdBorderStyle"> <!--80 millions-->                  
                   <apex:outputPanel rendered="{!if(lstAbsorptiveCapacity.size>0,true,false)}">
                       <apex:outputtext value="US $ " rendered="{!!isnull(lstAbsorptiveCapacity[0].Past_Average_Annual_Spend__c)}"/>
                       <apex:outputfield value="{!lstAbsorptiveCapacity[0].Past_Average_Annual_Spend__c}" rendered="{!!isnull(lstAbsorptiveCapacity[0].Past_Average_Annual_Spend__c)}"/>  
                       <apex:outputtext value="Missing Data" rendered="{!isnull(lstAbsorptiveCapacity[0].Past_Average_Annual_Spend__c)}"/> 
                   </apex:outputPanel>&nbsp;&nbsp;&nbsp;<br></br>  
                   
                    <apex:commandLink value="See data/comments" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000ZvTJ" target="_blank"/>
                </td>
             </tr>
             <apex:outputPanel >             
              <tr>
               <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;vertical-align:middle;">                       
                   <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextPastSpendAvg}','{!$Component.txthelpTextPastSpendAvg}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextPastSpendAvg}');">                      
                            <u>Past average spend rate</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextPastSpendAvg" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextPastSpendAvg" style="font-weight:normal !important;color:#000000 !important;" >
                            This is the average spend rate based on past EFR data. The numbers have been validated already by country teams and Program Finance.  This number feeds into whether a components must be reviewed for absorptive capacity.</apex:outputtext>
                     </apex:outputpanel>  
               </td>
               <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">
                   <apex:outputtext value="{!decSpendRate}%" rendered="{!!isnull(decSpendRate)}"/>
                   <apex:outputtext value="Missing Data" rendered="{!isnull(decSpendRate)}"/>
                <br/> 
               <apex:commandLink style="color:#0088CC !important;" value="See data/comments" action="/servlet/servlet.FileDownload?file=015b0000000ZvTJ" target="_blank"/>
               </td>
             </tr>
             </apex:outputPanel>
             <tr>
                <td width="60%" class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;vertical-align:middle">                    
                     <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextSpendRatio}','{!$Component.txthelpTextSpendRatio}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextSpendRatio}');">                      
                            <u>Spend Ratio:</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextSpendRatio" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextSpendRatio" style="font-weight:normal !important;color:#000000 !important;" >
                        This amount is the annualized Allocation for Review vs. the Past Average Annual Spend.  This number represents an estimation of a component's ability to absorb the Allocation for Review. This number feeds into whether a component must be reviewed for absorptive capacity. If the ratio is high, it suggests that there may be problems in absorbing the Allocation for Review.  If the number is low, it suggests that the component is likely to be able to absorb the full Allocation for Review.</apex:outputtext>
                     </apex:outputpanel>  
                      Annualized Allocation for Review / Past Average Annual Spend
                 </td>
                <td width="20%" class="tdBorderStyle"> <!--80 millions-->                  
                   <apex:outputPanel rendered="{!if(lstAbsorptiveCapacity.size>0,true,false)}">
                       <apex:outputfield value="{!lstAbsorptiveCapacity[0].Absorptive_Capacity_Spend_Ratio__c}" rendered="{!!isnull(lstAbsorptiveCapacity[0].Absorptive_Capacity_Spend_Ratio__c)}"/>                        
                       <apex:outputtext value="Missing Data" rendered="{!isnull(lstAbsorptiveCapacity[0].Absorptive_Capacity_Spend_Ratio__c)}"/> 
                   </apex:outputPanel>  
                </td>
             </tr> 
            <tr>
             <th colspan="2" class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
               <h4>Additional Financial Information</h4>
             </th>
            </tr>
            <tr>
                <td width="60%" class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;vertical-align:middle">                    
                    <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextExisting}','{!$Component.txthelpTextExisting}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextExisting}');">                      
                            <u>Existing pipeline</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextExisting" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextExisting" style="font-weight:normal !important;color:#000000 !important;" >
                        This is the total pipeline of undisbursed funds as of 31 December 2013.  It represents a combination of both commited and uncommited funds.  It serves as one of the components of the Minimum Required Level (MRL).  It also serves as a component of the Investment Minimum and Maximum (only for over allocated components).</apex:outputtext>
                     </apex:outputpanel>  
                    of funding (as of 31 December 2013)&nbsp;&nbsp;<br></br>                   
                    <apex:commandLink value="See details / guidance" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000b4XQ" target="_blank"/>        
                 </td>
                <td width="20%" class="tdBorderStyle">                  
                   <apex:outputtext value="US $ ">
                  </apex:outputText>
                  <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.Existing_Funding__c}"/> 
                   </apex:outputText>&nbsp;&nbsp;<br></br>                   
                   <apex:commandLink value="See data" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000b4Ms" target="_blank"/>
                </td>
            </tr>
            <tr>
                <td width="60%" class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;vertical-align:middle">                    
                    <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextPast4Year}','{!$Component.txthelpTextPast4Year}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextPast4Year}');">                      
                            <u>Past four year disbursements</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextPast4Year" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextPast4Year" style="font-weight:normal !important;color:#000000 !important;" >
                            This is the four year disbursement amount * 75%.  It serves as one of the components of the Minimum Required Level (MRL).  It also serves as a component of the Investment Minimum (only for under / appropriately allocated components) and Maximum (only for over allocated components).</apex:outputtext>
                     </apex:outputpanel>  (2010-2013) * 75%   
                    &nbsp;&nbsp;&nbsp;<br></br>
                    <apex:commandLink value="See details / guidance" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000b4XQ" target="_blank"/>
        
                 </td>
                <td width="20%" class="tdBorderStyle">            
                   <apex:outputtext value="US $ ">
                  </apex:outputText>
                  <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.MRL__c}"/> 
                   </apex:outputText>
                   &nbsp;&nbsp;<br></br>
                   <apex:commandLink value="See data" style="color:#0088CC !important;" action="/servlet/servlet.FileDownload?file=015b0000000b4Ms" target="_blank"/>
                </td>
            </tr>
            <tr>
                <!-- <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;">
                 <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextInvMin}','{!$Component.txthelpTextInvMin}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextInvMin}');">                      
                            <u>Investment Minimum</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextInvMin" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextInvMin" style="font-weight:normal !important;color:#000000 !important;" >
                        This is meant to serve as guidance for country teams when making adjustments for absorptive capacity and other considerations.  Teams should consider adjustments beyond this range, but should know that these will be flagged for additional review.  For over allocated components, this is defined as the higher of: the existing pipeline of funding or 77%* the Fair Share amount.  For under / appropriately allocated components, this is defined as the higher of: the existing pipeline of funds or the past four year disbursements*75%.</apex:outputtext>
                     </apex:outputpanel> - adjustments below this amount will be flagged for additional review</td>
                 <td class="tdBorderStyle">
                     <apex:outputtext value="US $ ">
                     </apex:outputText>
                     <apex:outputText value="{0,number,###,###,###}">
                         <apex:param value="{!Concept_Note__c.Investment_Minimum__c}"/> 
                     </apex:outputText>
                 </td>   -->     
           </tr>
           <tr>
             <!-- <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">
             
                <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextInvMax}','{!$Component.txthelpTextInvMax}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextInvMax}');">                      
                        <u>Investment Maximum</u>
                  </apex:outputPanel>                      
                 <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextInvMax" style="display:none;margin-top: 25px;left:12% !important;">
                        <apex:outputText id="txthelpTextInvMax" style="font-weight:normal !important;color:#000000 !important;" >
                    This is meant to serve as guidance for country teams when making adjustments for absorptive capacity and other considerations.  Teams should consider adjustments beyond this range, but should know that these will be flagged for additional review.  For over allocated components, this is defined as the Notional Funding Amount.  For under / appropriately allocated components, this is defined as 150% of the Fair Share amount (i.e. the amount the component would be considered "Significantly Over Allocated").</apex:outputtext>
                 </apex:outputpanel> - adjustments above this amount will be flagged for additional review</td>
             <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">
                 <apex:outputtext value="US $ ">
                 </apex:outputText>
                 <apex:outputText value="{0,number,###,###,###}">
                     <apex:param value="{!Concept_Note__c.Investment_Maximum__c}"/> 
                 </apex:outputText>
             </td> -->
          </tr>
          <!-- <tr>
             <td colspan="2" class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;vertical-align:middle">
               <i>Note: Because this component has been allocated its existing pipeline of funding and is over allocated (i.e. receiving more than the "fair share" of funding), the existing <br/>
               funding pipeline is both a maximum and minimum. Because of this, if the country team recommends either an increase or decrease in the Preliminary Allocation it will be flagged for additional review.</i>
             </td>
          </tr> -->
          <!--<apex:outputPanel rendered="{!if((Concept_Note__c.Allocation_Status__c == 'Overallocated' || Concept_Note__c.Allocation_Status__c == 'Significantly Overallocated') && Concept_Note__c.NFA__c == Concept_Note__c.Existing_Funding__c,true,false)}">
            <tr>
                <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">
                   <i>Note: Because this component has been allocated its existing pipeline of funding and is over allocated (i.e. receiving more than the "fair share" of funding), the existing funding pipeline is both a maximum and minimum. Because of this, if the country team recommends either an increase or decrease in the preliminary allocation, it will be flagged for additional review.</i>
                </td>
                <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">&nbsp;</td>
            </tr>
          </apex:outputPanel>-->              
         </apex:outputPanel>             
         <apex:outputpanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c == 'Finance Data Review' || Concept_Note__c.Absorptive_Capacity_Stage__c == 'Submitted' ,true,false)}">
          <tr>
             <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important">                         
                    <apex:outputPanel rendered="{!if(lstshare[0].Haseditaccess == true && objConceptNote.Absorptive_Capacity_Stage__c != 'Submitted',true,false)}">     
                       <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopup('{!$Component.tstpopup}','Absorptive_Capacity');" value="Accept"/>
                       <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-warning" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" onclick="return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Absorptive_Capacity');" value="Request Revision"/>
                       <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId && blnIsDisableSubmitAC == true,true,false)}" onclick="return cannotsubmitAbsorptiveCapacity()">                               
                            <apex:outputtext styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;background-image: none;box-shadow: none;cursor: default;opacity: 0.65;" value="Submit" ></apex:outputtext>
                       </apex:outputPanel>
                       <apex:outputPanel rendered="{!if($User.Id != Concept_Note__c.CCM_new__r.OwnerId || blnIsDisableSubmitAC == true || objConceptNote.Absorptive_Capacity_Stage__c == 'Submitted',false,true)}">
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="border-right:1px solid #E0E3E5 !important;font-weight:bold;" value="Submit" onclick="return OpenPopup('{!$Component.tstpopupSubmit}','');"/>                                    
                       </apex:outputPanel>
                       <apex:outputPanel rendered="{!if($User.Id == Concept_Note__c.CCM_new__r.OwnerId,true,false)}">
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE;font-weight:bold;" onclick="onClickSharingButton();return false;" value="Share"/>
                       </apex:outputPanel> 
                    </apex:outputPanel>                       
             </td>
             <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important">
                 <span class="label label-success" style="display:{!if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c != '' && lstAbsorptiveCapacity[0].Status__c != null ,'','none')};background:{!if(lstAbsorptiveCapacity.size>0 && (lstAbsorptiveCapacity[0].Status__c == 'Accepted' || lstAbsorptiveCapacity[0].Status__c == 'Update Request Accepted'),'#5BB75B',if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c == 'Update Requested','#FAA732',if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c == 'Update Request Denied','#FA5858','#2E9AFE')))} !important;">
                     {!if(lstAbsorptiveCapacity.size>0,lstAbsorptiveCapacity[0].Status__c,'')}
                 </span>  
             </td>
          </tr>
        </apex:outputpanel>          
           <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c == 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c == 'No Review Required',true,false)}">
             <tr>
                 <th colspan="2" class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#336699">
                   <center><h4>Country Team Review</h4></center>
                 </th>
            </tr>    
            <tr>
             <th class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
               <h4>Absorptive Capacity Review</h4>
             </th>  
             <th class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
               <span class="label label-info" style="background:{!if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c == 'Under CT Review','#66CCFF',if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c == 'Cap Amount Provided','#5BB75B',if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c == 'Justification Provided','#FF9966',if(lstAbsorptiveCapacity.size>0 && (lstAbsorptiveCapacity[0].Status__c == 'No Review Required' || lstAbsorptiveCapacity[0].Status__c == 'Cap Amount Submitted' || lstAbsorptiveCapacity[0].Status__c == 'Justification Submitted'),'#FA5858',''))))} !important;">
                   {!if(lstAbsorptiveCapacity.size>0,lstAbsorptiveCapacity[0].Status__c,'')}
               </span>                   
             </th>                 
           </tr>
           <tr>
              <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">
                  <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextACC}','{!$Component.txthelpTextACC}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextACC}');">                      
                        <u>Absorptive Capacity category</u>
                  </apex:outputPanel>                      
                 <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextACC" style="display:none;margin-top: 25px;left:12% !important;">
                        <apex:outputText id="txthelpTextACC" style="font-weight:normal !important;color:#000000 !important;" >
                    This is the category of review required based on the component's average spend rate and spend ratio.  Note that components with missing data have all been flagged as "Review".  If the component is flagged as "No Review Required" the country team does not need to evaluate the component for absorptive capacity.  However, in this case if they would like to recommend a reduction to the Allocation for Review, they should use the "Other Considerations" section below.</apex:outputtext>
                 </apex:outputpanel>, based on the average spend rate and the spend ratio above</td> 
              <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">     
                  {!if(lstAbsorptiveCapacity.size>0,lstAbsorptiveCapacity[0].Absorptive_Capacity_Matrix_Category__c,'')} 
             </td> 
           </tr> 
           <apex:outputPanel rendered="{!if(lstAbsorptiveCapacity.size>0 && (lstAbsorptiveCapacity[0].Absorptive_Capacity_Matrix_Category__c == 'Review' || lstAbsorptiveCapacity[0].Absorptive_Capacity_Matrix_Category__c == 'Review - Reduction Likely'),true,false)}">
           <tr>
                  <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">A category of "{!if(lstAbsorptiveCapacity.size>0,lstAbsorptiveCapacity[0].Absorptive_Capacity_Matrix_Category__c,'')}" requires that you either 
                      <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextSCAmtPJ}','{!$Component.txthelpTextSCAmtPJ}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextSCAmtPJ}');">                      
                            <u>set a cap amount or provide a justification</u>
                      </apex:outputPanel>                      
                     <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextSCAmtPJ" style="display:none;margin-top: 25px;left:12% !important;">
                            <apex:outputText id="txthelpTextSCAmtPJ" style="font-weight:normal !important;color:#000000 !important;" >
                        If a review is required based on the category above, country teams should select one of two options: 1) Justify Allocation: Provide justification for why the Allocation for Review should not be reduced or 2) Set Cap Amount: Propose an amount for which the Allocation for Review should not be allowed to exceed  based on absorptive capacity.  For example, if you wanted to recommend reducing a component's allocation from 100M to 70M, you would input 70M as the cap amount. </apex:outputtext>
                     </apex:outputpanel> that the country component can utilize the full proposed allocation amount</td> 
                  <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">
                   <apex:outputPanel rendered="{!if(objConceptNote.Absorptive_Capacity_Review_Status__c != 'Submitted',true,false)}">
                       <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold; !important;" onclick="return OpenPopupRequestUpdatedNew('{!$Component.tstpopupRequestUpdate}','Absorptive_Capacity','Justified Allocation');" 
                            value="Justify Allocation" rendered="{!if(($User.Id == Concept_Note__c.CCM_new__r.OwnerId) || (lstshare[0].HasEditAccess == true), true ,false)}"/><br/>                               
                       <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return OpenPopupRequestUpdatedNew('AC Set Cap Amount','Absorptive_Capacity','Set Cap Amount');return false;" value="Set Cap Amount"
                        rendered="{!if(($User.Id == Concept_Note__c.CCM_new__r.OwnerId) || (lstshare[0].HasEditAccess == true) , true ,false)}" /> 
                   </apex:outputPanel>
                 </td> 
           </tr> 
           </apex:outputPanel>   
           <apex:outputPanel rendered="{!if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Absorptive_Capacity_Matrix_Category__c == 'Accept',true,false)}">
           <tr>
              <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">A category of Accepted requires no further action on your part</td> 
              <td class="tdBorderStyle" style="border-bottom: 1px solid #DDDDDD !important;">&nbsp;</td> 
           </tr> 
           </apex:outputPanel>
           <tr>
             <th style="font-weight:normal !important;border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
               <apex:outputPanel style="cursor:pointer !important;" onMouseOver="onMouseOverHelpTextShow('{!$Component.ophelpTextOC}','{!$Component.txthelpTextOC}');" onMouseOut="onMouseOutHelpTextHide('{!$Component.ophelpTextOC}');">                      
                       <h4><u style="color:#ffffff;"><font style="color:#ffffff;font-weight:bold;font-size:14px;">Other Considerations</font></u></h4>
                  </apex:outputPanel>                      
                 <apex:outputpanel styleClass="helpTextAdjustment" id="ophelpTextOC" style="display:none;margin-top: 25px;left:12% !important;">
                        <apex:outputText id="txthelpTextOC" style="font-weight:normal !important;color:#000000 !important;" >
                        In this section country teams can input any other considerations, including <br/>a proposed increase or decrease to the Allocation for Review.
                         If the<br/> team would like to submit other considerations, they should click <br/>"Other Considerations."
                         If the team has no other considerations to submit, <br/>they should click "No Other Considerations."</apex:outputtext>
                 </apex:outputpanel>
             </th>  
             <th class="header" style="border-left: 1px solid #DDDDDD;border-right: 1px solid #DDDDDD;background-color:#2492B9">
               <span class="label label-info" style="background:{!if(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c == 'Under CT Review','#66CCFF',if(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c == 'Other Considerations Provided','#5BB75B',if(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c == 'No Other Considerations Provided','#FF9966',if(lstOtherConsideration.size>0 && (lstOtherConsideration[0].Status__c == 'No Other Considerations Submitted' || lstOtherConsideration[0].Status__c == 'No Review Required' || lstOtherConsideration[0].Status__c == 'Other Considerations Submitted'),'#FA5858',''))))} !important;">
                   {!if(lstOtherConsideration.size>0,lstOtherConsideration[0].Status__c,'')}
               </span>                   
             </th>    
           </tr> 
           <tr>
               <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">
                   If you believe that your allocation amount requires that other considerations be taken into account, please specify them here, along with a corresponding increase / decrease recommendation for the allocation.You may also upload supporting documents (be sure to click the Upload button after selecting each document). 
               </td> 
               <td class="tdBorderStyle" style="border-left: 1px solid #DDDDDD !important;border-bottom: 1px solid #DDDDDD !important;">
                   <apex:outputPanel rendered="{!if(objConceptNote.Absorptive_Capacity_Review_Status__c != 'Submitted',true,false)}">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;width:135px;" value="Other Considerations" 
                            onclick="return OpenPopupRequestUpdatedOther('{!$Component.tstpopupRequestUpdateOther}','Other_Considerations','Submit Other Consideration');return false;"/>                
                    <br/>
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold; !important;" value="No Other Considerations" 
                            onclick="return SetNoOtherConsideration('Other_Considerations','{!$Component.tstpopupNoConsideration}');return false;"/>                               
                   </apex:outputPanel> 
               </td>
           </tr>              
           </apex:outputPanel>
        </table>         
        <br/>     
        <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c == 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c == 'No Review Required',true,false)}">
            When you have completed reviewing your Absorptive Capacity and Other Considerations, please click Submit. Your submission will not be considered final until you do,and after submitting, you will not be able to revise your submission.
            <br/>
            <apex:commandLink id="cmlOtherSubmitUnderCt" styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="background:#DA4F49 !important;font-weight:bold;" value="Submit" onclick="return SetSubmittedRecordType('Other_Considerations','{!$Component.tstpopupSubmitReviewOld}'); return false;"
                    rendered="{!if(((lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c  == 'Under CT Review')||(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c  == 'Under CT Review')) && ($User.Id == Concept_Note__c.CCM_new__r.OwnerId || lstshare[0].HasEditAccess == true), true, false)}"/>              
            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="background:#DA4F49 !important;font-weight:bold;" value="Submit" onclick="return SetSubmittedRecordType('Other_Considerations','{!$Component.tstpopupSubmitReview}');" rendered="{!if(lstAbsorptiveCapacity.size>0 && lstAbsorptiveCapacity[0].Status__c  != 'Under CT Review' && lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c  != 'Under CT Review' && ($User.Id == Concept_Note__c.CCM_new__r.OwnerId || lstshare[0].HasEditAccess == true), true, false)}"/>               
        </apex:outputPanel>                           
       </div>
     </div>
  </div>   
 </td>
</tr>
    
<!-- Comment By <tr> 
    <apex:outputPanel rendered="{!if(Concept_Note__c.Absorptive_Capacity_Stage__c == 'Absorptive Capacity Review' || Concept_Note__c.Absorptive_Capacity_Stage__c == 'No Review Required' || Concept_Note__c.No_Absorptive_Capacity_Review_Required__c==true,true,false)}">     
       <td> 
       <div class="span2">          
         <div class="task_summary border"><br/><br/>                     
           <div class="number">           
             <div>
             
             </div>
             <br/><br/>
             <div>
               
             </div>
           </div>
         </div>
       </div>
    </td>
    <td>
        <div class="span10">
        <div class="task border">
        <div class="task_details ">
          <h3>Other Considerations </h3>
           
            <div class="label label-info">
              <h6>Status</h6> <br/>
              <apex:outputPanel >
                   <span class="label label-info" style="background:{!if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Data Finalized' || objConceptNote.Absorptive_Capacity_Review_Status__c == 'Accepted','#5BB75B',if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Under Review','#2E9AFE',if(objConceptNote.Absorptive_Capacity_Review_Status__c == 'Update Requested','#FAA732','')))} !important;">
                       {!if(lstOtherConsideration.size>0,lstOtherConsideration[0].Status__c,'')}
                   </span>
               </apex:outputPanel>
            </div>            
                     
          <br/><br/>
          <div class="">
            <p>If you believe that your allocation amount requires that other considerations be taken into account, please specify them here. You may upload supporting documents (be sure to click the Upload button after selecting each document).</p>
            <p><a href="#" style="color:#0088CC !important;">See details/guidance</a></p>
            
            
            <apex:outputPanel rendered="{!if(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c != 'Other Considerations Submitted' && lstOtherConsideration[0].Status__c != 'No Other Considerations Submitted',true,false)}">
                <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" value="Submit Other Considerations" 
                        onclick="return OpenPopupRequestUpdatedOther('{!$Component.tstpopupRequestUpdateOther}','Other_Considerations','Submit Other Consideration');return false;"/>
        
                    OR &nbsp; &nbsp; &nbsp;  
                <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" value="Confirm No Other Considerations" 
                        onclick="return SetNoOtherConsideration('Other_Considerations','{!$Component.tstpopupNoConsideration}');return false;"/>
                               
                <br/><br/>
                <apex:commandLink id="cmlOtherSubmitUnderCt" styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="background:#DA4F49 !important;font-weight:bold;" value="Submit" onclick="return SetSubmittedRecordType('Other_Considerations','{!$Component.tstpopupSubmitReview}'); return false;"
                        rendered="{!if(lstOtherConsideration.size>0 && lstOtherConsideration[0].Status__c  == 'Under CT Review' && ($User.Id == Concept_Note__c.CCM_new__r.OwnerId || lstshare[0].HasEditAccess == true), true, false)}"/> 
             
                 <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="background:#DA4F49 !important;font-weight:bold;" value="Submit" onclick="return SetSubmittedRecordType('Other_Considerations','{!$Component.tstpopupSubmitNoCTReview}'); return false;"
                        rendered="{!if(lstOtherConsideration.size>0 && (lstOtherConsideration[0].Status__c  == 'Draft Other Considerations Saved' || lstOtherConsideration[0].Status__c  == 'No Other Considerations Entered') && ($User.Id == Concept_Note__c.CCM_new__r.OwnerId || lstshare[0].HasEditAccess == true), true, false)}"/> 
             
            </apex:outputPanel> 
            <br/>
            
            
            <p>                
                <apex:inputTextArea id="inpAbsorptiveCapacity" value="{!strOtherConsideration}" style="width: 500px;"/>
                <br/>
                Proposed Adjustment:&nbsp;<apex:inputText value="{!decSProposedAmountAC}"/> 
                <br/>
                <table cellspacing="0" width="60%" cellpadding="0" border="0" >
                    <apex:variable value="{!0}" var="count"/>
                    <apex:repeat value="{!lstFeedItemsOtherConsideration}" var="FeedItem">
                    <tr>                
                        <td valign="top">
                            <apex:inputFile value="{!FeedItem.ContentData}" fileName="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName == null || FeedItem.ContentFileName == '',true,false)}"/>
                            <apex:outputText value="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName != null && FeedItem.ContentFileName != '',true,false)}"/>
                        </td>
                        <td valign="middle" align="right">
                            <apex:outputText value="Reference Pages: " /> 
                        </td>  
                        <td valign="middle">                
                            <apex:inputtext value="{!FeedItem.ContentDescription}" rendered="{!if(FeedItem.ContentDescription == null || FeedItem.ContentDescription == '',true,false)}"/>
                            <apex:outputText value="{!if(CONTAINS(FeedItem.ContentDescription,'See pg.'),RIGHT(FeedItem.ContentDescription,(FIND(' ', FeedItem.ContentDescription)-2)),FeedItem.ContentDescription)}" rendered="{!if(FeedItem.ContentDescription != null && FeedItem.ContentDescription != '',true,false)}"/>
                        </td>
                        <td valign="top">&nbsp;&nbsp;&nbsp;
                            <apex:commandLink value="Remove" onclick="document.getElementById('divProcessing').style.display = '';" action="{!removeOtherConsiderationFile}" rendered="{!if(count != lstFeedItemsOtherConsideration.size-1,true,false)}" style="color: #0088CC !important;">
                                <apex:param name="OIndex" value="{!count}"/>
                            </apex:commandLink>
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" value="Upload" onclick="document.getElementById('divProcessing').style.display = '';" action="{!uploadOtherConsiderationsFiles}" rendered="{!if(count == lstFeedItemsOtherConsideration.size-1,true,false)}" style="background: #0088CC !important;">
                                <apex:param name="RecordType" value="Absorptive_Capacity"/>
                            </apex:commandLink>
                            <apex:variable value="{!count+1}" var="count"/>
                        </td>
                    </tr>
                    </apex:repeat>  
                </table>               
            </p>            
          </div>
         </div>             
         <div class="task_workspace">
            <div class="pull_right">
            </div>           
           </div>
         </div>
      </div>
     </td> 
    </apex:outputPanel>
    </tr> End By  -->
    <apex:outputPanel rendered="{!if(Concept_Note__c.Final_Absorptive_Capacity_Review__c == 'Review',true,false)}">
    <tr>
     <td style="vertical-align:top">
    <div class="span2">
     <div class="task_summary border"> 
        <br/><br/>      
       <div class="number">        
         <div class="label label-info"> 
         <h6>Deadline</h6><br/>
         <apex:outputpanel styleclass="label label-info" style="background:#FA5858 !important;" rendered="{!if(Concept_Note__c.Final_Allocation_Review_Deadline__c != null,true,false)}">
             <apex:outputField value="{!Concept_Note__c.Final_Allocation_Review_Deadline__c}"/>
         </apex:outputpanel>
         </div><br/><br/>
         <div class="label label-info">
         <h6>Status</h6> <br/>
         <!--<span class="label label-warning">Not ready</span>-->          
               <span class="label label-info" style="background:{!if(Concept_Note__c.Absorptive_Capacity_Final_Alloc_Status__c == 'Data Finalized','#5BB75B',if(Concept_Note__c.Absorptive_Capacity_Final_Alloc_Status__c == 'Under Review','#2E9AFE',if(Concept_Note__c.Absorptive_Capacity_Final_Alloc_Status__c == 'Update Requested','#FAA732','')))} !important;">
                   {!Concept_Note__c.Absorptive_Capacity_Final_Alloc_Status__c}
               </span>            
         </div>
       </div>
     </div>
    </div>
     </td>
     <td>
     <div class="span10">
      <div class="task border">
        <div class="task_details ">
          <h3>Final Allocation </h3>
          <div class="">
            <p>Your allocation after the first GAC decision and the Board’s country band allocation is displayed below. Please review your absorptive capacity information. </p>
          </div>
        </div>
             
         <div class="task_workspace">
           <table class="table table-striped">
             <tr>
               <td> <span class="badge">1</span>Panel allocated amount</td>
               <td>100 Millions</td>
             </tr>
             <tr>
               <td><span class="badge">2</span> Amount after rescaling due to board band allocation </td>
               <td>{!Concept_Note__c.Final_Allocation__c}</td>
             </tr>
           </table>

           <h4>Check your absorptive capacity</h4>
           <p>The rescaled amount <span class="badge">2</span> is above your absorptive capacity and requires that you either set a cap amount or provide justification for review: <br/><br/>
           <button class="btn  btn-success" type="button" onclick="return OpenPopupRequestUpdated('FAC Set Cap Amount','Final_Allocation_Absorptive_Capacity');">Set cap amount</button> 
               or 
           <button class="btn  btn-primary" type="button"  onclick= "return OpenPopupRequestUpdated('{!$Component.tstpopupRequestUpdate}','Final_Allocation_Absorptive_Capacity');">Provide justification</button></p>                      
            <div class="pull_right">               
              <p>
                 <a href="#" style="color:#0088CC !important;">See a detailed description of this process.</a>
               </p> 
            </div>
         </div>           
       </div>
     </div>
     </td>
    </tr>
    </apex:outputPanel>
    
    <apex:outputPanel rendered="{!if(Concept_Note__c.Final_Absorptive_Capacity_Review__c == 'No Review Required' || Concept_Note__c.Final_Absorptive_Capacity_Review__c == 'Review',true,false)}">
    <tr>
     <td style="vertical-align:top"> 
    <div class="span2">          
         <div class="task_summary border"><br/><br/>                     
           <div class="number">           
             <div>
                <!-- <h6>Deadline</h6><br/>
                 <apex:outputPanel styleclass="label label-info" style="background:#FA5858 !important;" rendered="{!if(Concept_Note__c.Absorptive_Capacity_Review_Deadline__c != null,true,false)}">
                     15/01/2014
                 </apex:outputpanel>-->
             </div>
             <br/><br/>
             <div>
                 <!--<h6>Status</h6> <br/>
                 <apex:outputPanel rendered="{!if(Concept_Note__c.Performance_Impact_Rate_Risk_Stage__c == 'Finalized',true,false)}">
                   <span class="label label-info" style="background:{!if(Concept_Note__c.Absorptive_Capacity_Initial_Alloc_Status__c == 'Data Finalized','#5BB75B',if(Concept_Note__c.Absorptive_Capacity_Initial_Alloc_Status__c == 'Under Review','#FAA732',if(Concept_Note__c.Absorptive_Capacity_Initial_Alloc_Status__c == 'Update Requested','#2E9AFE','')))} !important;">
                       {!Concept_Note__c.Absorptive_Capacity_Initial_Alloc_Status__c}
                   </span>
                </apex:outputPanel>-->
             </div>
           </div>
         </div>
       </div>
        </td>
        <td>
     <div class="span10">
      <div class="task border">
        <div class="task_details ">
          <h3>Other Considerations </h3> <br/>
          <div class="">
            <p>If you believe that your allocation amount requires other considerations to be taken into account, please specify them here. </p> 
            <p><a href="#" style="color:#0088CC !important;">See details/guidance</a></p>
            <p> <apex:inputTextArea value="{!strFinalOtherConsideration}" style="width: 500px;"/>
                <br/>
                Proposed Adjustment:&nbsp;<apex:inputText value="{!decSProposedAmountFAC}"/> 
                <br/>
                <table cellspacing="0" width="60%" cellpadding="0" border="0" >
                    <apex:variable value="{!0}" var="i"/>
                    <apex:repeat value="{!lstFeedItemsFinalOtherConsideration}" var="FeedItem">
                    <tr>                
                        <td valign="top">
                            <apex:inputFile value="{!FeedItem.ContentData}" fileName="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName == null || FeedItem.ContentFileName == '',true,false)}"/>
                            <apex:outputText value="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName != null && FeedItem.ContentFileName != '',true,false)}"/>
                        </td>
                        <td valign="middle">
                            <apex:outputText value="Reference Pages: " /> 
                        </td>  
                        <td valign="middle">                
                            <apex:inputtext value="{!FeedItem.ContentDescription}" rendered="{!if(FeedItem.ContentDescription == null || FeedItem.ContentDescription == '',true,false)}"/>
                            <apex:outputText value="{!if(CONTAINS(FeedItem.ContentDescription,'See pg.'),RIGHT(FeedItem.ContentDescription,(FIND(' ', FeedItem.ContentDescription)-2)),FeedItem.ContentDescription)}" rendered="{!if(FeedItem.ContentDescription != null && FeedItem.ContentDescription != '',true,false)}"/>
                        </td>
                        <td valign="top">&nbsp;&nbsp;&nbsp;
                            <apex:commandLink value="Remove" onclick="document.getElementById('divProcessing').style.display = '';" action="{!removeFinalOtherConsiderationFile}" rendered="{!if(i != lstFeedItemsFinalOtherConsideration.size-1,true,false)}" style="color: #0088CC !important;">
                                <apex:param name="FOIndex" value="{!i}"/>
                            </apex:commandLink>
                            <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" value="Upload" onclick="document.getElementById('divProcessing').style.display = '';" action="{!uploadOtherConsiderationsFiles}" rendered="{!if(i == lstFeedItemsFinalOtherConsideration.size-1,true,false)}" style="background: #0088CC !important;">
                                <apex:param name="RecordType" value="Final_Allocation_Absorptive_Capacity"/>
                            </apex:commandLink>
                            <apex:variable value="{!i+1}" var="i"/>
                        </td>
                    </tr>
                    </apex:repeat>  
                </table>
                <table width="50%"  cellspacing="0" cellpadding="0" border="0" >
                   <!-- <tr>
                        <td>
                            <apex:commandLink value="Add another file" style="color:#0088CC !important;" action="{!AddNewFileFinalOtherConsideration}"/>
                        </td>
                    </tr>-->             
                    <tr>
                    <td align="center">                         
                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#2E9AFE !important;font-weight:bold;" onclick="return OnclickSaveOtherConsideration('Final_Allocation_Absorptive_Capacity','No');" value="Save"/>
                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="OnclickSubmitOtherConsideration('Final_Allocation_Absorptive_Capacity',null);return false;" value="Submit"/>                  
                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" value="Cancel"/>     
                    </td>
                   </tr>
               </table> 
             </p>          
          </div>
         </div>             
         <div class="task_workspace">
            <div class="pull_right">
            </div>           
           </div>
         </div>
      </div>
      </td>
      </tr>
      </apex:outputPanel>
      <!-- END of row -->
      </table>
   </div>
</div>


  <!-- Pop-up form -->
  <div id="req_upd" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    </div>
    <div class="modal-body">
      <h4>Update Request form</h4>
      <p>Please justify your adjustment request and provide all documents supporting it.</p>      
        <fieldset>
          <label>Argument</label>
          <textarea rows="5"></textarea>
          <label>Supporting documents</label>
          <input type="file" placeholder="supporting documents"/>
        </fieldset>     
    </div>
    <div class="modal-footer">
      <a href="#" class="btn">Cancel</a>
      <a href="#" class="btn btn-primary">Submit</a>
    </div>
  </div>

  <div id="abs_cap" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    </div>
    <div class="modal-body">      
        <h4>Absorptive capacity form</h4>
        <p>Please set the cap amount over which your country will not be able to use the allowed funds properly. Justify the amount you entered with an argument and provide all documents supporting it.</p>
        <fieldset>
          <label>Cap amount</label>
          <!--<input type="text"> Million $-->
          <label>Argument</label>
          <textarea rows="5"></textarea>
          <label>Supporting documents</label>
          <input type="file" placeholder="supporting documents"/>
        </fieldset>      
    </div>
    <div class="modal-footer">
      <a href="#" class="btn">Cancel</a>
      <a href="#" class="btn btn-primary">Submit</a>
    </div>
  </div>
 
<!-- Accept Onclick Popup -->
<apex:outputPanel id="tstpopup" style="display:none;">
<apex:outputPanel id="popupBackground" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopuptwo" styleClass="custPopup">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td>
                  <apex:outputtext id="optAcceptText" style="font-weight: bold;"/>
                  
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>                   
                <td width="47%" align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:50px;font-weight:bold;" onclick="return OnclickPCNStatusToAccepted();" value="Yes"/>              
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopup}');" value="Cancel"/>
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>

<!-- Confirm No Evidence Onclick Popup -->
<apex:outputPanel id="tstpopupCNE" style="display:none;">
<apex:outputPanel id="popupBackgroundCNE" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopuptwoCNE" styleClass="custPopup" style="height:252px !important;">
        <br/>
        <apex:outputPanel styleClass="RequestUpdatedOutputpanel" layout="block" style="width:302px !important;max-height:190px !important;">
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td>
                  <apex:outputtext style="font-weight: bold;" value="By selecting this option, you are confirming that you do not have evidence of increasing rates of infection for this component. Please provide a brief commentary addressing why these data were not available (e.g. CT didn't reach out to CCM, CT reached out but CCM didn't have data, etc.)"/>
                </td>
            </tr>             
            <tr><td/></tr>
            <tr>
                <td><apex:inputTextarea value="{!strCountryTeanJustification}" style="width:92%;"/></td>
            </tr>
        </table>
        </apex:outputPanel>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>                   
                <td align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="return OnclickPCNStatusToAcceptedIRI();" value="Confirm"/>                                 
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupCNE}');" value="Cancel"/>
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>

<!-- Submit Onclick Popup -->
<apex:outputPanel id="tstpopupSubmit" style="display:none;">
<apex:outputPanel id="popupBackgroundSubmit" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopuptSubmit" styleClass="custPopup" style="height:150px !important;">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td>
                  <apex:outputtext style="font-weight: bold;" value="Are you sure you want to submit this qualitative factor?"/>
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>                   
                <td width="47%" align="center">                
                <apex:outputpanel >
                    <apex:commandlink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:180px;font-weight:bold;" onclick="return onClickSubmit();" value="Submit Qualitative Factor"/>                                     
                    <apex:commandlink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSubmit}');" value="Cancel"/>
                </apex:outputpanel>
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>

<!-- Submit All Onclick Popup -->
<apex:outputPanel id="tstpopupSubmitAll" style="display:none;">
<apex:outputPanel id="popupBackgroundSubmitAll" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopuptSubmitAll" styleClass="custPopup" style="height:150px !important;">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td>
                  <apex:outputtext style="font-weight: bold;" value="Are you sure you want to submit your qualitative factors? You will not be able to request updates once you have submitted."/>
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>                   
                <td width="47%" align="center">                
                <apex:outputpanel >
                    <apex:commandlink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:180px;font-weight:bold;" onclick="return onClickSubmitAll();" value="Submit all Qualitative Factors"/>                                     
                    <apex:commandlink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSubmitAll}');" value="Cancel"/>
                </apex:outputpanel>
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>
<!-- Added By  -->
<apex:outputPanel id="tstpopupRequestUpdateOther" rendered="{!if(ShowRequestUpdatePanelOther == 'Yes',true,false)}">
    <apex:outputPanel id="popupBackgroundRequestUpdateOther" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopupOther" styleClass="custPopupToRequestUpdated">
        <br/>
        <apex:outputPanel >
        <apex:outputPanel styleClass="RequestUpdatedOutputpanel" layout="block">
            <apex:outputPanel >
                <table cellspacing="0" cellpadding="0" border="0" >
                    <tr>
                        <td>
                            <apex:outputText style="font-weight: bold;" value="If you believe that your allocation amount requires that other considerations be taken into account, please specify them here, along with a corresponding increase / decrease recommendation for the allocation.You may also upload supporting documents (be sure to click the Upload button after selecting each document)."></apex:outputText>
                        </td>
                    </tr>
                    <tr><td></td></tr>  
                    <tr>
                        <td>               
                            <apex:inputTextArea id="inpAbsorptiveCapacity" value="{!strOtherConsideration}" style="width: 480px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Proposed Adjustment in USD (if a decrease, include negative sign, i.e. -200000):&nbsp;<apex:inputText id="iptProAmtOC" value="{!decSProposedAmountAC}" onchange="ChangeOCProposedAmount('{!Concept_Note__c.Final_Allocation__c}','{!$Component.iptProAmtOC}','{!Concept_Note__c.Maximum__c}','{!Concept_Note__c.Minimum__c}');return false;"/>                             
                        </td>
                    </tr>                    
                    <!--<apex:outputPanel rendered="{!if(Concept_Note__c.Final_Allocation__c != null && decCapAmountAC != null && (Concept_Note__c.Maximum__c != null && (Concept_Note__c.Final_Allocation__c+decSProposedAmountAC) > Concept_Note__c.Maximum__c ) || (Concept_Note__c.Minimum__c != null && (Concept_Note__c.Final_Allocation__c+decSProposedAmountAC) < Concept_Note__c.Minimum__c),true,false)}">
                        <tr>
                            <td>Note: The proposed adjustment exceeds this country-component's maximum" or "The proposed adjustment would put this country-component below its minimum.</td>
                        </tr>
                    </apex:outputPanel>-->
                    
                    <tr id="OpProAmountMax" style="display:none;">
                        <td><i>Note: The proposed adjustment exceeds this country-component's maximum.</i></td>
                    </tr>                    
                     <tr id="OpProAmountMin" style="display:none;"> 
                         <td><i>Note: The proposed adjustment would put this country-component below its minimum</i></td>
                     </tr>                    
                    <tr>
                        <td>
                            <table cellspacing="0" cellpadding="0" border="0" >
                                <apex:variable value="{!0}" var="count"/>
                                <apex:repeat value="{!lstFeedItemsOtherConsideration}" var="FeedItem">
                                <tr>                
                                    <td valign="top">
                                        <apex:inputFile value="{!FeedItem.ContentData}" fileName="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName == null || FeedItem.ContentFileName == '',true,false)}"/>
                                        <apex:outputText value="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName != null && FeedItem.ContentFileName != '',true,false)}"/>
                                    </td>
                                    <td valign="middle" align="right">
                                        <apex:outputText value="Reference Pages: " /> 
                                    </td>  
                                    <td valign="middle">                
                                        <apex:inputtext value="{!FeedItem.ContentDescription}" rendered="{!if(FeedItem.ContentDescription == null || FeedItem.ContentDescription == '',true,false)}"/>
                                        <apex:outputText value="{!if(CONTAINS(FeedItem.ContentDescription,'See pg.'),RIGHT(FeedItem.ContentDescription,(FIND(' ', FeedItem.ContentDescription)-2)),FeedItem.ContentDescription)}" rendered="{!if(FeedItem.ContentDescription != null && FeedItem.ContentDescription != '',true,false)}"/>
                                    </td>
                                    <td valign="top">&nbsp;&nbsp;&nbsp;
                                        <apex:commandLink value="Remove" onclick="showProcessingOther();" action="{!removeOtherConsiderationFile}" rendered="{!if(count != lstFeedItemsOtherConsideration.size-1,true,false)}" style="color: #0088CC !important;">
                                            <apex:param name="OIndex" value="{!count}"/>
                                        </apex:commandLink> 
                                        
                                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" value="Upload" onclick="showProcessingOther();" action="{!uploadOtherConsiderationsFiles}" rendered="{!if(count == lstFeedItemsOtherConsideration.size-1,true,false)}" style="background: #0088CC !important;">
                                            <apex:param name="RecordType" value="Other_Considerations"/>
                                        </apex:commandLink>
                                        <apex:variable value="{!count+1}" var="count"/>
                                    </td>
                                </tr>
                                </apex:repeat>  
                            </table>
                        </td>
                    </tr>
                </table>
            </apex:outputPanel> 
        </apex:outputPanel> 
              
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
                         
                    <tr>
                    <td align="center">                         
                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="return OnclickSaveOtherConsideration('Other_Considerations','Save');" value="Save Other Considerations"/> 
                        <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" value="Cancel" onclick="return ClosePopup('{!$Component.tstpopupRequestUpdateOther}');"/>
                    </td>
                   </tr>
               </table> 
        </apex:outputPanel>
        <script>          
            ChangeOCProposedAmount('{!Concept_Note__c.Final_Allocation__c}','{!$Component.iptProAmtOC}','{!Concept_Note__c.Maximum__c}','{!Concept_Note__c.Minimum__c}');
        </script> 
    </apex:outputPanel>
</apex:outputPanel>

            

<!-- End Added by  -->
<!-- Request Update Onclick Popup -->
<apex:outputPanel id="tstpopupRequestUpdate" rendered="{!if(ShowRequestUpdatePanel == 'Yes',true,false)}">    
    <apex:outputPanel id="popupBackgroundRequestUpdate" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopup" styleClass="custPopupToRequestUpdated">
        <br/>
        <apex:outputPanel >
        <apex:outputPanel styleClass="RequestUpdatedOutputpanel" layout="block">
         <apex:outputPanel >
            <table cellspacing="0" cellpadding="0" border="0" >
                <tr>
                    <td colspan="4">
                        <apex:outputText style="font-weight: bold;" rendered="{!if(strRecordTypeName == 'Increasing_Rate_of_Infection' || strRecordTypeName == 'Risk' || strRecordTypeName == 'Performance'|| strRecordTypeName == 'Absorptive_Capacity',false,true)}" value="Please provide a justification for your request. You may upload documents to support your request."/>
                        <apex:outputText style="font-weight: bold;" rendered="{!if(strRecordTypeName == 'Increasing_Rate_of_Infection' ,true,false)}" value="Please submit evidence of increasing rates of infection.  This evidence will be reviewed by a panel of partners to determine whether it qualifies for the 5% top up."/>
                        <apex:outputText style="font-weight: bold;" rendered="{!if(strRecordTypeName == 'Risk',true,false)}" value="Changes to risk should only be made for exceptional circumstances. If you believe this country-component's risk status should be re-evaluated, please provide a justification."/>
                        <apex:outputText style="font-weight: bold;" rendered="{!if(strRecordTypeName == 'Performance',true,false)}" value="If you believe this country-component's performance rating should be re-evaluated, please provide a justification. Note that there is no distinction between A1 and A2 performance ratings for the purpose of this exercise."/>
                        <apex:outputText id="optAC" value="{!if(strShowJustifiedAllocation == 'Justified Allocation','Please describe why this component should receive the allocation amount listed in the table on this page. You may upload documents to support your justification.','Please enter a cap amount, the maximum allocation you believe this component should receive, and describe why you have chosen this as the cap amount. You may upload documents to support your justification.')}" rendered="{!if(strRecordTypeName == 'Absorptive_Capacity', true,false)}" style="font-weight: bold;"/>
                    </td>
                </tr> 
               <!--<tr><td colspan="4">&nbsp;</td></tr>-->
                <tr>
                    <td colspan="4">                        
                        <apex:inputTextarea id="iptaCountryTeam" value="{!strCountryTeanJustification}" style="width:480px;height:60px;"/>                    
                    </td>
                </tr>
                <tr>
                    <apex:outputPanel rendered="{!if(showsetCapAmount == 'ACYes',true,false)}">  
                        <td colspan="4">Proposed Cap Amount (i.e. 3400000 or 1800000):&nbsp;<apex:inputText id="iptCapAmountAc" value="{!decCapAmountAC}" onchange="ChangeACProposedAmount('{!$Component.iptCapAmountAc}','{!Concept_Note__c.Maximum__c}','{!Concept_Note__c.Minimum__c}');return false;"/></td>
                    </apex:outputPanel> 
                    <apex:outputPanel rendered="{!if(showsetCapAmount == 'FACYes',true,false)}">  
                        <td colspan="4">Proposed Cap Amount:&nbsp;<apex:inputText value="{!decCapAmountFAC}"/></td>
                    </apex:outputPanel>                   
                </tr>                  
                <tr id="opSetCapAmtMax" style="display:none;">
                    <td colspan="4"><i>Note: Based on the cap amount provided, this country-component's allocation would be above the maximum.</i></td>
                </tr> 
                <tr id="opSetCapAmtMin" style="display:none;">
                    <td colspan="4"><i>Note: Based on the cap amount provided, this country-component's allocation would be below the minimum.</i></td>
                </tr>             
                <tr>
                    <apex:outputPanel rendered="{!if(strRecordTypeName == 'Increasing_Rate_of_Infection' ,true,false)}">  
                        <td colspan="4">Affected subpopulation(s):&nbsp;(max 255 characters)
                            <apex:inputTextarea value="{!strAffectedSubPopulation}"/></td>
                    </apex:outputPanel>
                </tr>            
                <tr>
                    <apex:outputpanel rendered="{!if(strRecordTypeName == 'Performance',true,false)}">
                        <td colspan="4">
                            <apex:outputtext value="Suggested performance rating : " style="font-weight:bold"/>
                            <apex:inputfield value="{!lstPerformance[0].CT_Suggested_Performance_Rating__c}"/>
                        </td>
                    </apex:outputPanel>
                </tr>                
                <tr>
                    <apex:outputpanel rendered="{!if(strRecordTypeName == 'Impact',true,false)}">
                        <td colspan="4">                    
                            <apex:outputtext value="Suggested impact rating : " style="font-weight:bold"/>
                            <apex:inputfield value="{!lstImpact[0].CT_Suggested_Impact_Rating__c}"/>
                        </td>
                    </apex:outputpanel>
                </tr>
               
                <tr><td colspan="4">&nbsp;</td></tr>            
                <apex:variable value="{!0}" var="count"/>  
                <apex:repeat id="rptFeeditems" value="{!lstFeedItems}" var="FeedItem">
                <tr>                
                    <td valign="top">
                        <apex:inputFile value="{!FeedItem.ContentData}" fileName="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName == null || FeedItem.ContentFileName == '',true,false)}"/>
                        <apex:outputText value="{!FeedItem.ContentFileName}" rendered="{!if(FeedItem.ContentFileName != null && FeedItem.ContentFileName != '',true,false)}"/>                                 
                    </td>
                    <td valign="top">
                        <apex:outputText value="Reference Pages: " /> 
                    </td>              
                    <td valign="top">                        
                        <apex:inputtext id="txtDescription" value="{!FeedItem.ContentDescription}"  rendered="{!if(FeedItem.Id == null || objConceptNote.Performance_Impact_Rate_Risk_Stage__c != 'Submitted',true,false)}"/>                      
                        <script>                            
                            if(document.getElementById('pg:frm:rptFeeditems:{!count}:txtDescription').value != ''){
                                var strDesc =  document.getElementById('pg:frm:rptFeeditems:{!count}:txtDescription').value;
                                document.getElementById('pg:frm:rptFeeditems:{!count}:txtDescription').value = strDesc.substring(8,strDesc.length); 
                            }
                        </script>
                        <apex:outputText value="{!if(CONTAINS(FeedItem.ContentDescription,'See pg.'),RIGHT(FeedItem.ContentDescription,(FIND(' ', FeedItem.ContentDescription)-2)),FeedItem.ContentDescription)}" rendered="{!if(FeedItem.Id != null && objConceptNote.Performance_Impact_Rate_Risk_Stage__c == 'Submitted',true,false)}"/>
                    </td>
                    <td valign="top">&nbsp;&nbsp;&nbsp;
                            <apex:commandLink value="Remove" onclick="showProcessing();" style="color:#0088CC !important;" action="{!removeRequestUpdateUploadFiles}" rendered="{!if(count != lstFeedItems.size-1,true,false)}">
                                <apex:param name="Index" value="{!count}"/>
                            </apex:commandLink> 
                             <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="background:#0088CC !important;" value="Upload" onclick="showProcessing();" action="{!uploadPCNRequestUpdatedFile}" rendered="{!if(count == lstFeedItems.size-1,true,false)}"/>                                                                                       
                        <apex:variable value="{!count+1}" var="count"/>
                    </td>
                </tr>
                </apex:repeat>                        
            </table>
            </apex:outputPanel> 
            <script>
                ChangeACProposedAmount('{!$Component.iptCapAmountAc}','{!Concept_Note__c.Maximum__c}','{!Concept_Note__c.Minimum__c}')
            </script>
        </apex:outputPanel> 
              
         <table width="100%" cellspacing="0" cellpadding="0" border="0" >
           <!--<tr>
                <td>
                    <apex:commandLink value="Add another file" style="color:#0088CC !important;" action="{!AddNewFile}"/>
                </td>
            </tr>-->
            <tr>
                <td align="center">                                      
                   <!-- <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" onclick="OnclickSavePCNRequestUpdated();return false;" style="background:#2E9AFE !important;font-weight:bold;" value="Save"/> -->
                    <!--<apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" onclick="OnclickSavePCNRequestUpdated();return false;" style="background:#2E9AFE !important;font-weight:bold;" value="Save Draft"/>-->
                    <apex:commandLink id="cmlRqRevsion" styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:120px;font-weight:bold;" onclick="OnclickPCNStatusToRequestUpdated();return false;"  value="{!if(strShowJustifiedAllocation == 'Set Cap Amount','Set Cap Amount',if(strShowJustifiedAllocation == 'Justified Allocation','Justify Allocation','Request Revision'))}"/>
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick=" return ClosePopup('{!$Component.tstpopupRequestUpdate}');" value="Cancel"/>
                </td>                
             </tr>                            
        </table> 
        </apex:outputPanel>
        <br/>      
    </apex:outputPanel>
</apex:outputPanel>

<!-- Functional Team Onclick Popup -->
<apex:outputPanel id="tstpopupFunctionalTeam" rendered="{!if(ShowFunctionalTeamPanel == 'Yes',true,false)}">
<apex:outputPanel id="popupBackgroundFunctionalTeam" styleClass="popupBackground"/>    
    <apex:outputPanel id="custPopuptFT" styleClass="custPopupToFunctionalTeam">
        <br/>
        <apex:outputPanel styleClass="Outputpanelmain" layout="block">
            <table width="100%" cellspacing="0" cellpadding="0" border="0" >
                <tr>
                    <td colspan="4">
                        <apex:outputtext value="{!strFunctionalTeamComments}" id="optFunctionalTeam" style="font-weight: bold;"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
               <apex:repeat value="{!lstwrpFunctionalTeam}" var="objAttach">
                <tr>
                    <td valign="top">                                            
                      <apex:outputLink value="{!objAttach.strType}" target="_blank" style="color:#0088CC !important;">Download</apex:outputLink>                     
                    </td>                
                    <td valign="top">                        
                        <apex:outputText value="{!objAttach.strFileName}"/>
                    </td>
                    <td  valign="top">
                        <apex:outputText value="Reference Pages: " /> 
                    </td>  
                    <td valign="top">                                         
                         <apex:outputText value="{!objAttach.strReferencePages}"/>
                    </td>                   
                </tr>
                </apex:repeat>
              </table>
       </apex:outputPanel> <br/>                                  
       <center><apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupFunctionalTeam}');" value="Close"/></center>              
    </apex:outputPanel>
</apex:outputPanel>

<!-- Rating Onclick Popup -->
<!--<apex:outputPanel id="tstpopupRating" style="display:none;">
<apex:outputPanel id="popupBackgroundRating" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopuptRating" styleClass="custPopupRating">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td align="center">
                    <apex:outputtext id="optRating" style="font-weight: bold;"/>
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>
                <td align="center">
                   <apex:commandlink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupRating}');" value="Close"/>                   
                </td>               
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>-->

<!-- Set Cap Amount Onclick Popup -->
<apex:outputPanel id="tstpopupSetCap" style="display:none;">
<apex:outputPanel id="popupBackgroundSetCap" styleClass="popupBackground"/>
    <apex:outputPanel id="custPopupSetCap" styleClass="custPopup">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td>
                    <apex:outputtext style="font-weight: bold;" value="Please set a cap amount: "/>                   
                    <input type="text" value="{!decCapAmountProvided}"/>
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>
                <td align="center">
                    <!--<apex:commandButton styleClass="popupButtonYes" value="Yes" onclick="OnclickSetCapAmountPopUp();">                      
                    </apex:commandButton>-->              
                     <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:50px;font-weight:bold;" onclick="return OnclickSetCapAmountPopUp();" value="Yes"/>
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSetCap}');" value="Cancel"/>
                    <!--<apex:commandButton styleClass="popupButtonCancel" value="Cancel" onclick="return ClosePopup('{!$Component.tstpopupSetCap}');"/>-->
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>

<!-- Added By  Start-->
<!-- Submit click Popup -->
<apex:outputPanel id="tstpopupSubmitReviewOld" style="display:none;">
<apex:outputPanel id="popupBackgroundSubmitReviewOld" styleClass="popupBackground" />
    <apex:outputPanel id="custPopupSubmitReviewOld" styleClass="custPopup">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td align="center">
                    <apex:outputtext style="font-weight: bold;" value="Please either enter a cap amount or provide a justification for your allocation and/or confirm whether you would like other factors to be considered before submitting your review."/>                                       
                </td>
            </tr>                  
            <tr>
                <td align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="width:50px;font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSubmitReviewOld}');" value="Ok"/>                    
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>

<apex:outputPanel id="tstpopupSubmitReview" style="display:none;">
<apex:outputPanel id="popupBackgroundSubmitReview" styleClass="popupBackground" />
    <apex:outputPanel id="custPopupSubmitReview" styleClass="custPopup" style="height:150px !important;">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td align="center">
                    <apex:outputtext style="font-weight: bold;" value="Are you sure you want to make your final Absorptive Capacity and  Other Considerations submission? You will no longer be able to edit your submission."/>                                       
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>
                <td align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="return onclickACSubmit();" value="Submit"/>                    
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSubmitReview}');" value="Cancel"/>                    
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>
<!---Submit Click with no Under CT review ---------->
<!--<apex:outputPanel id="tstpopupSubmitNoCTReview" style="display:none;">
<apex:outputPanel id="popupBackgroundSubmitNoReview" styleClass="popupBackground" />
    <apex:outputPanel id="custPopupSubmitNoReview" styleClass="custPopup">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td align="center">
                    <apex:outputtext style="font-weight: bold;" value="Are you sure you want to make your final Other Considerations submission? You will no longer be able to edit your submission."/>                   
                    
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>
                <td align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" value="Submit" onclick="OnclickSubmitOtherConsideration('Other_Considerations','{!$Component.tstpopupSubmitNoCTReview}');return false;"/>                    
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupSubmitNoCTReview}');" value="Cancel"/>
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>-->

<!-- NoConsideration click Popup -->
<apex:outputPanel id="tstpopupNoConsideration" style="display:none;">
<apex:outputPanel id="popupBackgroundNoConsideration" styleClass="popupBackground" />
    <apex:outputPanel id="custPopupNoConsideration" styleClass="custPopup">
        <br/>
        <table width="100%" cellspacing="0" cellpadding="0" border="0" >
            <tr>
                <td align="center">
                    <apex:outputtext style="font-weight: bold;" value="Are you sure you do not want to submit any additional material for the Global Fund to consider in making final allocation decisions?"/>                   
                    
                </td>
            </tr> 
            <tr><td>&nbsp;</td></tr>           
            <tr>
                <td align="center">
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-success" style="font-weight:bold;" onclick="return OnclickSaveOtherConsideration('Other_Considerations','NoOther');" value="Confirm No Other Considerations"/>
                    <apex:commandLink styleclass="TGFbtn TGFbtn-mini TGFbtn-danger" style="font-weight:bold;" onclick="return ClosePopup('{!$Component.tstpopupNoConsideration}');" value="Cancel"/>
               
                </td>
            </tr>
        </table>
    </apex:outputPanel>
</apex:outputPanel>
<!-- Added By  End-->
<script>
    window.onload = setFocus();
        function setFocus() {
    }    
</script>
</apex:form>
        <!------------- Start: Processing Div---------------------------------------->
        <style>
            .ProcessingBackground{
                background-color: black;
                opacity: 0.50;
                filter: alpha(opacity = 50);
                width: 100%;
                height: 100%;
                position: fixed;
                z-index: 10000;                
                top:0;
                left:0;
            }
            .Processing{
                z-index: 10001;
                left: 50%;
                top: 50%;
                text-align: center;
                position: fixed;
            }        
        </style>
        <div id="divProcessing" style="display:none;">
            <div class="ProcessingBackground"></div>
            <div class="Processing">
                <apex:image alt="Processing"  value="/img/loading32.gif" />
            </div>
        </div>  
      
        <!------------- End: Processing Div---------------------------------------->  
<script src="http://code.jquery.com/jquery.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
                 
</body>
</apex:page>